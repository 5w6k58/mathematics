<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PRIMARY SEO META TAGS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<title>MATHEMATICS ($MATH) â€” Free Online Math Tools | Calculator, Geometry, Graphing & More</title>
<meta name="description" content="MATHEMATICS ($MATH) is a free online math platform for students worldwide. Use our scientific calculator, function grapher, geometry calculator, formula library, statistics tools, equation solver and more â€” all in one place. Also a crypto token on Pump.fun.">
<meta name="keywords" content="mathematics, math tools, online calculator, scientific calculator, graphing calculator, geometry calculator, math formulas, algebra formulas, calculus formulas, trigonometry, statistics calculator, equation solver, linear equation, quadratic equation, matrix operations, number theory, prime numbers, fibonacci, unit converter, fraction calculator, math education, free math tools, students, STEM, mathematics token, $MATH, pump.fun, crypto, math coin, math crypto, solana, meme coin math, calculus, integral, derivative, statistics, probability, complex numbers, vectors, logarithm, binomial theorem, pythagorean theorem, quadratic formula, trigonometric identities, function graphing, linear regression">
<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<meta name="googlebot" content="index, follow">
<meta name="bingbot" content="index, follow">
<meta name="author" content="MATHEMATICS Project">
<meta name="language" content="English">
<meta name="revisit-after" content="3 days">
<meta name="rating" content="general">
<meta name="category" content="education, mathematics, tools, cryptocurrency">
<link rel="canonical" href="https://5w6k58.github.io/mathematics/">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     OPEN GRAPH (Facebook, LinkedIn, Discord, Telegram)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://5w6k58.github.io/mathematics/">
<meta property="og:title" content="MATHEMATICS ($MATH) â€” Free Online Math Tools + Crypto Token">
<meta property="og:description" content="Free online math platform: scientific calculator, graphing, geometry, 100+ formulas, statistics, equation solver and more. Built for students worldwide. Also available as $MATH token on Pump.fun.">
<meta property="og:image" content="https://5w6k58.github.io/mathematics/math-logo.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="MATHEMATICS - Free Math Tools Website">
<meta property="og:site_name" content="MATHEMATICS">
<meta property="og:locale" content="en_US">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     TWITTER / X CARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@MathsCoin">
<meta name="twitter:creator" content="@MathsCoin">
<meta name="twitter:title" content="MATHEMATICS ($MATH) â€” Free Math Tools + Crypto Token">
<meta name="twitter:description" content="Scientific calculator, graphing, geometry, formulas, statistics & more â€” free for all students. $MATH token on Pump.fun.">
<meta name="twitter:image" content="https://5w6k58.github.io/mathematics/math-logo.png">
<meta name="twitter:image:alt" content="MATHEMATICS - Free Online Math Tools">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     STRUCTURED DATA â€” JSON-LD
     (Google Rich Results: WebApplication + FAQPage)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebApplication",
  "name": "MATHEMATICS â€” Free Online Math Tools",
  "url": "https://5w6k58.github.io/mathematics/",
  "description": "A comprehensive free online mathematics platform offering scientific calculator, function graphing, geometry calculator, formula library with 100+ formulas, statistics analysis, equation solver, matrix operations, number theory tools, unit converter, and fraction calculator.",
  "applicationCategory": "EducationalApplication",
  "operatingSystem": "Web Browser",
  "browserRequirements": "Requires JavaScript",
  "offers": {
    "@type": "Offer",
    "price": "0",
    "priceCurrency": "USD"
  },
  "featureList": [
    "Basic & Scientific Calculator",
    "Function Graphing with multiple equations",
    "Geometry Calculator (12 shapes: square, rectangle, triangle, circle, cube, cylinder, sphere, cone, pyramid, parallelogram, trapezoid)",
    "Formula Library with 100+ formulas in 9 categories",
    "Unit Converter (10 categories: length, area, volume, mass, temperature, speed, angle, time, energy, pressure)",
    "Matrix Operations (determinant, inverse, transpose, multiplication)",
    "Number Theory (prime checker, GCD/LCM, factorization, Fibonacci, Euler totient)",
    "Statistical Analysis with linear regression",
    "Equation Solver (linear, quadratic, cubic, systems)",
    "Fraction Calculator",
    "Interactive Whiteboard"
  ],
  "audience": {
    "@type": "EducationalAudience",
    "educationalRole": "student"
  },
  "educationalLevel": "elementary, middle school, high school, college",
  "about": {
    "@type": "Thing",
    "name": "Mathematics"
  },
  "inLanguage": "en",
  "isAccessibleForFree": true,
  "license": "https://opensource.org/licenses/MIT"
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "What is MATHEMATICS ($MATH)?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "MATHEMATICS ($MATH) is a free online math tools platform and cryptocurrency token on Pump.fun (Solana). The website provides a scientific calculator, function grapher, geometry calculator, formula library, statistics tools, and more â€” all free for students worldwide."
      }
    },
    {
      "@type": "Question",
      "name": "How do I use the online scientific calculator?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Click the 'Scientific' tab to access the full scientific calculator with sin, cos, tan, arcsin, arccos, arctan, square root, cube root, natural log, log base 10, log base 2, exponential, absolute value, floor, ceiling, and rounding functions."
      }
    },
    {
      "@type": "Question",
      "name": "Can I graph multiple math functions at once?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes. Click the 'Graphing' tab to plot multiple functions simultaneously. You can customize colors, adjust x/y axis ranges, and use any JavaScript math expression including Math.sin, Math.cos, Math.sqrt, Math.abs, Math.exp, Math.log, and more."
      }
    },
    {
      "@type": "Question",
      "name": "What geometry shapes does the calculator support?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The geometry calculator supports 12 shapes: square, rectangle, triangle (with Heron's formula), circle, parallelogram, trapezoid, cube, cylinder, sphere, cone, square pyramid, and right triangle (Pythagorean theorem)."
      }
    },
    {
      "@type": "Question",
      "name": "Where can I buy the $MATHEMATICS token?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The $MATHEMATICS token is available on Pump.fun on the Solana blockchain. Visit pump.fun/coin/mathematics to purchase. Note: cryptocurrency carries risk â€” only invest what you can afford to lose."
      }
    },
    {
      "@type": "Question",
      "name": "Is MATHEMATICS free to use?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes, MATHEMATICS is completely free to use, open source (MIT License), and has no ads. All 12 math tools including the calculator, graphing, geometry, formulas, statistics, and equation solver are free for all students."
      }
    },
    {
      "@type": "Question",
      "name": "What math formulas are available?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "The formula library contains 100+ formulas across 9 categories: Algebra (quadratic formula, binomial theorem, AM-GM inequality), Trigonometry (Pythagorean identity, sum/difference formulas, law of sines/cosines), Calculus (derivatives, chain rule, L'HÃ´pital's rule), Integration, Probability (Bayes' theorem, binomial distribution), Series (arithmetic, geometric, Fibonacci), Logarithms, Vectors, and Complex numbers (Euler's formula, De Moivre)."
      }
    }
  ]
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "MATHEMATICS",
  "url": "https://5w6k58.github.io/mathematics/",
  "sameAs": [
    "https://x.com/MathsCoin",
    "https://pump.fun/coin/mathematics"
  ],
  "description": "MATHEMATICS is an open-source math education platform and Solana crypto token.",
  "logo": "https://5w6k58.github.io/mathematics/math-logo.png"
}
</script>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PERFORMANCE & MISC
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<meta name="theme-color" content="#07000f">
<meta name="msapplication-TileColor" content="#07000f">
<meta name="application-name" content="MATHEMATICS">
<meta name="apple-mobile-web-app-title" content="MATHEMATICS">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">

<!--
  MATHEMATICS Web App
  License: MIT (free to use, modify, distribute)
  Fonts: Google Fonts (Open Font License) â€” Press Start 2P, VT323, Share Tech Mono
  No third-party scripts, no tracking, no ads, no external dependencies beyond Google Fonts.
  All math logic is original implementation.
-->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MATHEMATICS â€” Design System
   Vaporwave Aesthetic + Steve Jobs Clarity
   Every element earns its place.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:        #07000f;
  --surface:   #0e0020;
  --surface2:  #0a0018;
  --border:    rgba(155,89,255,0.25);
  --border2:   rgba(0,245,255,0.2);
  --pink:      #ff2d78;
  --purple:    #9b59ff;
  --cyan:      #00f5ff;
  --green:     #39ff14;
  --yellow:    #ffe600;
  --text:      #e8d5ff;
  --muted:     rgba(232,213,255,0.5);
  --grid-col:  rgba(155,89,255,0.11);
  --r:         2px;
  --fpx:       'Press Start 2P', monospace;
  --fvt:       'VT323', monospace;
  --fmono:     'Share Tech Mono', monospace;
}

*,*::before,*::after { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 16px; scroll-behavior: smooth; }

body {
  background: var(--bg);
  color: var(--text);
  font-family: var(--fmono);
  font-size: 1rem;
  min-height: 100vh;
  overflow-x: hidden;
  line-height: 1.5;
}

/* Background grid */
body::before {
  content: '';
  position: fixed; inset: 0; z-index: 0; pointer-events: none;
  background:
    linear-gradient(var(--grid-col) 1px, transparent 1px),
    linear-gradient(90deg, var(--grid-col) 1px, transparent 1px);
  background-size: 44px 44px;
}
/* Scanlines */
body::after {
  content: '';
  position: fixed; inset: 0; z-index: 1; pointer-events: none;
  background: repeating-linear-gradient(
    0deg, transparent, transparent 3px,
    rgba(0,0,0,0.07) 3px, rgba(0,0,0,0.07) 4px
  );
}

/* â”€â”€ Layout â”€â”€ */
#app { position: relative; z-index: 2; display: flex; flex-direction: column; min-height: 100vh; }

/* â”€â”€ Header â”€â”€ */
header {
  text-align: center;
  padding: 2.5rem 1rem 1.5rem;
  border-bottom: 1px solid var(--border);
  background: linear-gradient(180deg, rgba(155,89,255,0.07) 0%, transparent 100%);
}

.logo {
  font-family: var(--fpx);
  font-size: clamp(1.1rem, 4vw, 2.2rem);
  color: var(--cyan);
  text-shadow: 0 0 8px var(--cyan), 0 0 28px rgba(0,245,255,0.3);
  letter-spacing: 4px;
  animation: flicker 6s infinite;
  line-height: 1.5;
  display: block;
}
.logo-sub {
  font-family: var(--fvt);
  font-size: clamp(1.1rem, 3vw, 1.6rem);
  color: var(--pink);
  text-shadow: 0 0 12px var(--pink);
  letter-spacing: 5px;
  margin-top: 6px;
  display: block;
}

@keyframes flicker {
  0%,94%,100%{opacity:1} 95%{opacity:.65} 97%{opacity:1} 98.5%{opacity:.55}
}

/* Pixel mascot */
.mascot-wrap {
  display: flex; align-items: center; justify-content: center;
  gap: 16px; margin: 1.2rem 0 0.4rem;
}
#mascotCanvas { image-rendering: pixelated; cursor: pointer; display: block; }

/* Real logo image */
.math-logo-img {
  width: 180px;
  height: 180px;
  object-fit: contain;
  border-radius: 16px;
  box-shadow: 0 0 28px rgba(0,245,255,0.4), 0 0 56px rgba(155,89,255,0.25);
  transition: transform .3s, box-shadow .3s;
  cursor: pointer;
  animation: logoFloat 4s ease-in-out infinite;
}
.math-logo-img:hover {
  transform: scale(1.06);
  box-shadow: 0 0 40px rgba(0,245,255,0.65), 0 0 80px rgba(155,89,255,0.4);
}
@media (max-width: 480px) {
  .math-logo-img { width: 140px; height: 140px; }
}
@keyframes logoFloat {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-6px); }
}
.loader-dots { display: flex; flex-direction: column; gap: 3px; }
.loader-row { display: flex; gap: 3px; }
.dot { width: 8px; height: 8px; background: var(--cyan); animation: blinkdot 1.4s infinite; }
.dot:nth-child(2){background:var(--pink);animation-delay:.2s}
.dot:nth-child(3){background:var(--purple);animation-delay:.4s}
.dot:nth-child(4){background:var(--yellow);animation-delay:.6s}
.loader-row:nth-child(2) .dot{animation-delay:.8s}
.loader-row:nth-child(2) .dot:nth-child(2){animation-delay:1s}
.loader-row:nth-child(2) .dot:nth-child(3){animation-delay:1.2s}
.loader-row:nth-child(2) .dot:nth-child(4){animation-delay:1.4s}
@keyframes blinkdot{0%,100%{opacity:.2}50%{opacity:1}}

/* â”€â”€ Navigation â”€â”€ */
nav {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 6px;
  padding: 10px 14px;
  background: rgba(14,0,32,0.85);
  border-bottom: 1px solid var(--border);
  position: sticky; top: 0; z-index: 100;
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
}
.nav-btn {
  font-family: var(--fpx);
  font-size: .5rem;
  padding: 13px 10px;
  background: transparent;
  border: 1px solid var(--border);
  color: var(--muted);
  cursor: pointer;
  transition: all .15s;
  white-space: nowrap;
  border-radius: var(--r);
  line-height: 1.6;
  text-align: center;
  width: 100%;
}
.nav-btn:hover { color: var(--cyan); border-color: var(--cyan); background: rgba(0,245,255,0.07); }
.nav-btn.active { color: var(--bg); background: var(--cyan); border-color: var(--cyan); box-shadow: 0 0 14px rgba(0,245,255,0.45); }

/* Mobile: force 2-column equal grid */
@media (max-width: 768px) {
  nav {
    grid-template-columns: 1fr 1fr;
    gap: 5px;
    padding: 8px 10px;
  }
  .nav-btn {
    padding: 14px 6px;
    font-size: .48rem;
  }
}

/* â”€â”€ Main â”€â”€ */
main { flex: 1; padding: 20px 16px; max-width: 1100px; margin: 0 auto; width: 100%; }

.panel { display: none; animation: fadeUp .25s ease; }
.panel.active { display: block; }
@keyframes fadeUp { from{opacity:0;transform:translateY(8px)} to{opacity:1;transform:none} }

/* â”€â”€ Cards â”€â”€ */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  padding: 20px;
  margin-bottom: 16px;
  position: relative;
  border-radius: var(--r);
  overflow: hidden;
}
.card::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--pink), var(--purple), var(--cyan));
}
.card-title {
  font-family: var(--fpx);
  font-size: .65rem;
  color: var(--cyan);
  text-shadow: 0 0 8px var(--cyan);
  margin-bottom: 18px;
  letter-spacing: 2px;
  line-height: 1.8;
}

/* â”€â”€ Form elements â”€â”€ */
input[type=text],
input[type=number],
select,
textarea {
  background: rgba(0,0,0,0.5);
  border: 1px solid rgba(155,89,255,0.4);
  color: var(--cyan);
  font-family: var(--fmono);
  font-size: 1rem;
  padding: 9px 12px;
  outline: none;
  transition: border-color .15s, box-shadow .15s;
  border-radius: var(--r);
  width: 100%;
  -webkit-appearance: none;
  appearance: none;
}
input:focus, select:focus, textarea:focus {
  border-color: var(--cyan);
  box-shadow: 0 0 8px rgba(0,245,255,0.2);
}
input[type=number]::-webkit-inner-spin-button { opacity: .4; }
select option { background: #0e0020; color: var(--text); }
label {
  font-size: .85rem;
  color: var(--muted);
  display: block;
  margin-bottom: 5px;
  margin-top: 12px;
  font-family: var(--fmono);
}
label:first-child { margin-top: 0; }

/* â”€â”€ Buttons â”€â”€ */
.btn {
  font-family: var(--fmono);
  font-size: .9rem;
  padding: 9px 16px;
  border: 1px solid var(--purple);
  background: rgba(155,89,255,0.1);
  color: var(--text);
  cursor: pointer;
  transition: all .15s;
  white-space: nowrap;
  border-radius: var(--r);
  line-height: 1.4;
}
.btn:hover { background: var(--purple); color: #fff; box-shadow: 0 0 12px rgba(155,89,255,0.45); }
.btn:active { transform: scale(.97); }
.btn-c  { border-color:var(--cyan);   background:rgba(0,245,255,0.07); color:var(--cyan); }
.btn-c:hover  { background:var(--cyan);   color:var(--bg); box-shadow:0 0 12px rgba(0,245,255,0.45); }
.btn-p  { border-color:var(--pink);   background:rgba(255,45,120,0.07); color:var(--pink); }
.btn-p:hover  { background:var(--pink);   color:#fff; box-shadow:0 0 12px rgba(255,45,120,0.45); }
.btn-g  { border-color:var(--green);  background:rgba(57,255,20,0.07);  color:var(--green); }
.btn-g:hover  { background:var(--green);  color:var(--bg); }
.btn.on { background:var(--cyan); color:var(--bg); border-color:var(--cyan); }

/* â”€â”€ Result boxes â”€â”€ */
.result {
  font-family: var(--fvt);
  font-size: 1.3rem;
  color: var(--green);
  text-shadow: 0 0 8px rgba(57,255,20,0.3);
  background: rgba(0,0,0,0.4);
  border: 1px solid rgba(57,255,20,0.22);
  padding: 12px 14px;
  min-height: 48px;
  border-radius: var(--r);
  word-break: break-all;
  white-space: pre-wrap;
  margin-top: 10px;
  line-height: 1.5;
}

/* â”€â”€ Grid helpers â”€â”€ */
.g2  { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.g3  { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; }
.ga  { display:grid; grid-template-columns:repeat(auto-fill,minmax(240px,1fr)); gap:12px; }
.row { display:flex; gap:10px; flex-wrap:wrap; }
.row.center { align-items:center; }
.mt  { margin-top:10px; }
.mt2 { margin-top:18px; }

@media(max-width:640px){
  .g2 { grid-template-columns:1fr; }
  .g3 { grid-template-columns:1fr 1fr; }
}
@media(max-width:400px){
  .g3 { grid-template-columns:1fr; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CALCULATOR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.calc-screen {
  background: rgba(0,0,0,0.7);
  border: 1px solid var(--cyan);
  box-shadow: 0 0 12px rgba(0,245,255,0.12), inset 0 0 20px rgba(0,0,0,0.5);
  padding: 12px 16px;
  margin-bottom: 12px;
  min-height: 82px;
  display: flex; flex-direction: column; justify-content: flex-end;
  border-radius: var(--r);
}
.calc-expr {
  font-family: var(--fmono);
  font-size: .85rem;
  color: var(--muted);
  text-align: right;
  min-height: 20px;
  word-break: break-all;
}
.calc-val {
  font-family: var(--fvt);
  font-size: 2.4rem;
  color: var(--cyan);
  text-align: right;
  text-shadow: 0 0 10px var(--cyan);
  word-break: break-all;
  line-height: 1.2;
}
.calc-grid { display:grid; grid-template-columns:repeat(5,1fr); gap:5px; }
.cb {
  font-family: var(--fmono);
  font-size: .95rem;
  padding: 13px 6px;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(155,89,255,0.28);
  color: var(--text);
  cursor: pointer;
  transition: all .12s;
  user-select: none;
  border-radius: var(--r);
  text-align: center;
  line-height: 1.3;
}
.cb:hover { background:rgba(155,89,255,0.22); border-color:var(--purple); }
.cb:active { transform:scale(.93); }
.cb.op  { color:var(--pink); }
.cb.fn  { color:var(--cyan);  font-size:.82rem; }
.cb.clr { color:var(--yellow); }
.cb.eq  {
  background: linear-gradient(135deg, var(--pink), var(--purple));
  color:#fff; border:none; font-weight:bold;
  box-shadow:0 0 12px rgba(155,89,255,0.35);
  font-size:1.1rem;
}
.cb.eq:hover { box-shadow:0 0 20px rgba(155,89,255,0.6); }
.span2 { grid-column:span 2; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DRAW CANVAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.toolbar { display:flex; flex-wrap:wrap; gap:6px; margin-bottom:10px; align-items:center; }
#drawCanvas {
  display:block; width:100%; touch-action:none;
  background:#040010;
  border:1px solid rgba(155,89,255,0.3);
  cursor:crosshair;
  border-radius:var(--r);
}
input[type=color] {
  width:38px; height:38px; padding:3px;
  border:1px solid var(--purple);
  background:transparent; cursor:pointer;
  border-radius:var(--r);
}
input[type=range] { accent-color:var(--purple); width:80px; }
.size-lbl { font-size:.85rem; color:var(--muted); white-space:nowrap; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GRAPH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#graphCanvas {
  display:block; width:100%;
  background:#030010;
  border:1px solid rgba(0,245,255,0.2);
  border-radius:var(--r);
}
.func-row { display:flex; gap:8px; align-items:center; margin-bottom:8px; flex-wrap:wrap; }
.func-lbl { font-family:var(--fmono); color:var(--cyan); white-space:nowrap; font-size:.95rem; }
.func-row input[type=text] { flex:1; min-width:150px; }
.func-row input[type=color] { width:34px; height:34px; }
.range-row { display:flex; gap:8px; flex-wrap:wrap; align-items:center; margin-bottom:10px; }
.range-row input { width:70px; }
.range-row span { color:var(--muted); font-size:.9rem; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GEOMETRY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.geo-card {
  background:rgba(0,0,0,0.3);
  border:1px solid var(--border);
  padding:14px;
  border-radius:var(--r);
  transition:border-color .2s;
}
.geo-card:hover { border-color:var(--purple); }
.geo-title {
  font-family:var(--fpx);
  font-size:.52rem;
  color:var(--pink);
  margin-bottom:10px;
  letter-spacing:1px;
  line-height:1.8;
}
.geo-canvas { display:block; margin:0 auto 10px; }
.geo-result {
  font-family:var(--fvt);
  font-size:1.1rem;
  color:var(--green);
  min-height:34px;
  margin-top:8px;
  line-height:1.55;
  word-break:break-word;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FORMULAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cat-row { display:flex; flex-wrap:wrap; gap:5px; margin-bottom:14px; }
.cat-btn {
  font-family:var(--fmono);
  font-size:.85rem;
  padding:7px 13px;
  background:transparent;
  border:1px solid rgba(155,89,255,0.3);
  color:var(--muted);
  cursor:pointer;
  transition:all .15s;
  border-radius:var(--r);
}
.cat-btn:hover,.cat-btn.active {
  border-color:var(--pink); color:var(--pink);
  background:rgba(255,45,120,0.09);
}
.formula-grid { display:none; }
.formula-grid.show {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(270px,1fr));
  gap:10px;
}
.fcard {
  background:rgba(0,0,0,0.35);
  border:1px solid rgba(155,89,255,0.25);
  padding:13px;
  cursor:pointer;
  transition:all .2s;
  border-radius:var(--r);
}
.fcard:hover { border-color:var(--cyan); box-shadow:0 0 10px rgba(0,245,255,0.12); transform:translateY(-1px); }
.fcard-name { font-family:var(--fpx); font-size:.48rem; color:var(--pink); margin-bottom:8px; letter-spacing:1px; line-height:1.8; }
.fcard-expr { font-family:var(--fvt); font-size:1.35rem; color:var(--cyan); text-shadow:0 0 6px rgba(0,245,255,0.22); line-height:1.4; }
.fcard-desc { font-size:.82rem; color:var(--muted); margin-top:5px; line-height:1.45; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UNIT CONVERTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.conv-wrap { display:grid; grid-template-columns:1fr auto 1fr; gap:12px; align-items:end; }
.conv-arrow { font-size:1.7rem; color:var(--pink); padding-bottom:10px; text-align:center; }
.conv-result-val { font-family:var(--fvt); font-size:1.7rem; color:var(--green); text-shadow:0 0 8px rgba(57,255,20,0.3); line-height:1.3; min-height:38px; }
@media(max-width:500px){
  .conv-wrap { grid-template-columns:1fr; }
  .conv-arrow { transform:rotate(90deg); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MATRIX
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.mat-wrap { overflow-x:auto; }
.mat-row { display:flex; gap:4px; margin-bottom:4px; align-items:center; }
.mat-cell {
  width:64px; flex-shrink:0;
  background:rgba(0,0,0,0.5);
  border:1px solid rgba(155,89,255,0.35);
  color:var(--cyan);
  font-family:var(--fmono);
  font-size:.9rem;
  padding:7px;
  text-align:center;
  outline:none;
  border-radius:var(--r);
}
.mat-result {
  font-family:var(--fmono);
  font-size:.9rem;
  color:var(--green);
  background:rgba(0,0,0,0.45);
  border:1px solid rgba(57,255,20,0.2);
  padding:14px;
  margin-top:12px;
  white-space:pre;
  overflow-x:auto;
  border-radius:var(--r);
  min-height:60px;
  line-height:1.7;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NUMBER THEORY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.nt-card { background:rgba(0,0,0,0.3); border:1px solid var(--border); padding:14px; border-radius:var(--r); }
.nt-title { font-family:var(--fpx); font-size:.52rem; color:var(--pink); margin-bottom:10px; line-height:1.8; letter-spacing:1px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATISTICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.stat-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(155px,1fr)); gap:8px; margin-top:14px; }
.stat-item { background:rgba(0,0,0,0.4); border:1px solid rgba(155,89,255,0.25); padding:10px; border-radius:var(--r); }
.stat-key { font-family:var(--fpx); font-size:.45rem; color:var(--pink); margin-bottom:5px; line-height:1.8; }
.stat-val { font-family:var(--fvt); font-size:1.45rem; color:var(--cyan); }
#statChart,#regChart {
  display:block; width:100%;
  background:#030010;
  border:1px solid rgba(155,89,255,0.2);
  border-radius:var(--r);
  margin-top:14px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EQUATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.eq-panel { display:none; }
.eq-panel.active { display:block; }
.eq-hint { font-size:.88rem; color:var(--muted); margin-bottom:12px; font-family:var(--fmono); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#toast {
  position:fixed; bottom:24px; left:50%; transform:translateX(-50%);
  background:var(--purple); color:#fff;
  font-family:var(--fmono); font-size:.9rem;
  padding:12px 22px;
  z-index:9999; display:none;
  border-radius:var(--r);
  box-shadow:0 0 20px var(--purple);
  pointer-events:none;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FOOTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
footer {
  text-align:center; padding:24px 16px;
  border-top:1px solid var(--border);
  background:linear-gradient(0deg,rgba(155,89,255,0.05) 0%,transparent 100%);
}
.foot-title { font-family:var(--fpx); font-size:.6rem; color:var(--pink); text-shadow:0 0 8px var(--pink); line-height:1.8; }
.foot-sub { font-family:var(--fvt); font-size:1.05rem; color:var(--muted); margin-top:6px; }

/* â”€â”€ CTA Buttons â”€â”€ */
.cta-wrap {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 14px;
  margin: 20px 0 8px;
}
.cta-btn {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  font-family: var(--fpx);
  font-size: .52rem;
  letter-spacing: 1px;
  padding: 13px 22px;
  border-radius: var(--r);
  text-decoration: none;
  cursor: pointer;
  transition: all .18s;
  border: none;
  line-height: 1.7;
  position: relative;
  overflow: hidden;
}
.cta-btn::before {
  content:'';
  position:absolute; inset:0;
  background:rgba(255,255,255,0.08);
  transform:translateX(-100%);
  transition:transform .3s;
}
.cta-btn:hover::before { transform:translateX(0); }
.cta-pump {
  background: linear-gradient(135deg, #ff2d78, #9b59ff);
  color: #fff;
  box-shadow: 0 0 20px rgba(255,45,120,0.4), 0 0 40px rgba(155,89,255,0.2);
}
.cta-pump:hover {
  box-shadow: 0 0 30px rgba(255,45,120,0.7), 0 0 60px rgba(155,89,255,0.35);
  transform: translateY(-2px);
}
.cta-twitter {
  background: linear-gradient(135deg, #1a1a2e, #0f3460);
  color: var(--cyan);
  border: 1px solid var(--cyan);
  box-shadow: 0 0 14px rgba(0,245,255,0.15);
}
.cta-twitter:hover {
  background: var(--cyan);
  color: var(--bg);
  box-shadow: 0 0 25px rgba(0,245,255,0.5);
  transform: translateY(-2px);
}
.cta-icon { font-size: 1.1rem; }

/* â”€â”€ Community Section â”€â”€ */
.community {
  margin: 0;
  padding: 36px 16px 28px;
  text-align: center;
  border-top: 1px solid var(--border);
  background: linear-gradient(0deg, rgba(155,89,255,0.06) 0%, transparent 100%);
}
.community-title {
  font-family: var(--fpx);
  font-size: .62rem;
  color: var(--cyan);
  text-shadow: 0 0 10px var(--cyan);
  margin-bottom: 24px;
  letter-spacing: 2px;
  line-height: 1.9;
}
.quotes-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
  gap: 14px;
  max-width: 900px;
  margin: 0 auto 28px;
  text-align: left;
}
.quote-card {
  background: rgba(0,0,0,0.35);
  border: 1px solid var(--border);
  border-radius: var(--r);
  padding: 16px 18px;
  position: relative;
}
.quote-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 2px;
  background: linear-gradient(90deg, var(--purple), var(--pink));
}
.quote-mark {
  font-family: var(--fvt);
  font-size: 2rem;
  color: var(--purple);
  line-height: .8;
  margin-bottom: 6px;
  display: block;
}
.quote-text {
  font-family: var(--fmono);
  font-size: .88rem;
  color: var(--text);
  line-height: 1.65;
}
.quote-tag {
  font-family: var(--fpx);
  font-size: .42rem;
  color: var(--pink);
  margin-top: 10px;
  display: block;
  letter-spacing: 1px;
  line-height: 1.9;
}
.contract-note {
  font-family: var(--fmono);
  font-size: .82rem;
  color: var(--muted);
  margin-top: 6px;
  line-height: 1.6;
}
.ticker-tape {
  font-family: var(--fpx);
  font-size: .45rem;
  color: var(--purple);
  letter-spacing: 2px;
  margin-top: 20px;
  opacity: .6;
  line-height: 2;
  animation: flicker 8s infinite;
}

/* â”€â”€ Scrollbar â”€â”€ */
::-webkit-scrollbar { width:5px; height:5px; }
::-webkit-scrollbar-track { background:var(--bg); }
::-webkit-scrollbar-thumb { background:var(--purple); border-radius:3px; }

hr { border:none; border-top:1px solid var(--border); margin:16px 0; }
</style>
</head>
<body>
<div id="app">

<!-- â•â• HEADER â•â• -->
<header>
  <h1 class="logo">$MATHEMATICS</h1>
  <p class="logo-sub">âˆ THE INFINITE MATH UNIVERSE âˆ</p>
  <div class="mascot-wrap">
    <div class="loader-dots">
      <div class="loader-row"><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
      <div class="loader-row"><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
    </div>
    <img src="math-logo.png" alt="MATHEMATICS Mascot" class="math-logo-img" title="MATHEMATICS â€” The Infinite Math Universe" onclick="this.style.transform='scale(1.15) rotate(5deg)';setTimeout(()=>this.style.transform='',400)">
    <canvas id="mascotCanvas" width="128" height="128" title="MATHBOT-9000" style="display:none;"></canvas>
    <div class="loader-dots">
      <div class="loader-row"><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
      <div class="loader-row"><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
    </div>
  </div>
  <!-- CTA Buttons -->
  <div class="cta-wrap">
    <a href="https://pump.fun/coin/mathematics" target="_blank" rel="noopener noreferrer" class="cta-btn cta-pump">
      <span class="cta-icon">ğŸš€</span> BUY $MATHS on pump.fun
    </a>
    <a href="https://x.com/MathsCoin" target="_blank" rel="noopener noreferrer" class="cta-btn cta-twitter">
      <span class="cta-icon">ğ•</span> Follow on X
    </a>
  </div>
</header>

<!-- â•â• NAV â•â• -->
<nav id="mainNav" aria-label="Math Tools Navigation">
  <button class="nav-btn active" data-panel="calc">ğŸ”¢ Calculator</button>
  <button class="nav-btn" data-panel="sci">ğŸ§® Scientific</button>
  <button class="nav-btn" data-panel="draw">âœï¸ Whiteboard</button>
  <button class="nav-btn" data-panel="graph">ğŸ“ˆ Graphing</button>
  <button class="nav-btn" data-panel="geo">ğŸ“ Geometry</button>
  <button class="nav-btn" data-panel="formula">ğŸ“š Formulas</button>
  <button class="nav-btn" data-panel="unit">âš–ï¸ Unit Conv.</button>
  <button class="nav-btn" data-panel="matrix">ğŸ”¡ Matrix</button>
  <button class="nav-btn" data-panel="numth">ğŸ” Number Theory</button>
  <button class="nav-btn" data-panel="stat">ğŸ“Š Statistics</button>
  <button class="nav-btn" data-panel="equation">ğŸ“ Equations</button>
  <button class="nav-btn" data-panel="fraction">Â½ Fractions</button>
</nav>

<main aria-label="Math Tools Interactive Panel">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: BASIC CALCULATOR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-calc" class="panel active">
  <div class="card">
    <div class="card-title">// BASIC CALCULATOR</div>
    <div class="calc-screen">
      <div class="calc-expr" id="cExpr"></div>
      <div class="calc-val"  id="cVal">0</div>
    </div>
    <div class="calc-grid">
      <button class="cb clr" onclick="cAC()">AC</button>
      <button class="cb clr" onclick="cDel()">âŒ«</button>
      <button class="cb fn"  onclick="cIn('(')">( </button>
      <button class="cb fn"  onclick="cIn(')')"> )</button>
      <button class="cb op"  onclick="cIn('/')">Ã·</button>

      <button class="cb" onclick="cIn('7')">7</button>
      <button class="cb" onclick="cIn('8')">8</button>
      <button class="cb" onclick="cIn('9')">9</button>
      <button class="cb fn" onclick="cIn('%')">%</button>
      <button class="cb op" onclick="cIn('*')">Ã—</button>

      <button class="cb" onclick="cIn('4')">4</button>
      <button class="cb" onclick="cIn('5')">5</button>
      <button class="cb" onclick="cIn('6')">6</button>
      <button class="cb fn" onclick="cIn('**2')">xÂ²</button>
      <button class="cb op" onclick="cIn('-')">âˆ’</button>

      <button class="cb" onclick="cIn('1')">1</button>
      <button class="cb" onclick="cIn('2')">2</button>
      <button class="cb" onclick="cIn('3')">3</button>
      <button class="cb fn" onclick="cIn('**')">xâ¿</button>
      <button class="cb op" onclick="cIn('+')">+</button>

      <button class="cb span2" onclick="cIn('0')">0</button>
      <button class="cb"   onclick="cIn('.')">.</button>
      <button class="cb fn" onclick="cIn('Math.PI')">Ï€</button>
      <button class="cb eq" onclick="cEval()">=</button>
    </div>
    <div style="margin-top:10px;font-size:.82rem;color:var(--muted);">Keyboard supported: digits, +âˆ’Ã—Ã·, Enter, Backspace, Escape</div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: SCIENTIFIC CALCULATOR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-sci" class="panel">
  <div class="card">
    <div class="card-title">// SCIENTIFIC CALCULATOR</div>
    <div class="calc-screen">
      <div class="calc-expr" id="sExpr"></div>
      <div class="calc-val"  id="sVal">0</div>
    </div>
    <!-- Scientific functions row -->
    <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:5px;margin-bottom:7px;">
      <button class="cb fn" onclick="sWrap('Math.sin(',')','sin(')">sin</button>
      <button class="cb fn" onclick="sWrap('Math.cos(',')','cos(')">cos</button>
      <button class="cb fn" onclick="sWrap('Math.tan(',')','tan(')">tan</button>
      <button class="cb fn" onclick="sWrap('Math.asin(',')','asin(')">asin</button>
      <button class="cb fn" onclick="sWrap('Math.acos(',')','acos(')">acos</button>
      <button class="cb fn" onclick="sWrap('Math.atan(',')','atan(')">atan</button>
      <button class="cb fn" onclick="sWrap('Math.sqrt(',')','âˆš(')">âˆšx</button>
      <button class="cb fn" onclick="sWrap('Math.cbrt(',')','âˆ›(')">âˆ›x</button>
      <button class="cb fn" onclick="sWrap('Math.log(',')','ln(')">ln</button>
      <button class="cb fn" onclick="sWrap('Math.log10(',')','log(')">logâ‚â‚€</button>
      <button class="cb fn" onclick="sWrap('Math.log2(',')','logâ‚‚(')">logâ‚‚</button>
      <button class="cb fn" onclick="sWrap('Math.exp(',')','e^(')">eË£</button>
      <button class="cb fn" onclick="sWrap('Math.abs(',')','|','|')">|x|</button>
      <button class="cb fn" onclick="sWrap('Math.floor(',')','âŒŠ')">âŒŠxâŒ‹</button>
      <button class="cb fn" onclick="sWrap('Math.ceil(',')','âŒˆ')">âŒˆxâŒ‰</button>
      <button class="cb fn" onclick="sWrap('Math.round(',')','round(')">round</button>
      <button class="cb fn" onclick="sIn('Math.PI','Ï€')">Ï€</button>
      <button class="cb fn" onclick="sIn('Math.E','e')">e</button>
      <button class="cb fn" onclick="sDeg()">Â°â†’rad</button>
      <button class="cb fn" onclick="sRad()">radâ†’Â°</button>
    </div>
    <!-- Digit/operator grid -->
    <div style="display:grid;grid-template-columns:repeat(5,1fr);gap:5px;">
      <button class="cb clr" onclick="sAC()">AC</button>
      <button class="cb clr" onclick="sDel()">âŒ«</button>
      <button class="cb fn"  onclick="sIn('(','(')">( </button>
      <button class="cb fn"  onclick="sIn(')',')')"> )</button>
      <button class="cb op"  onclick="sIn('/','Ã·')">Ã·</button>
      <button class="cb" onclick="sIn('7','7')">7</button>
      <button class="cb" onclick="sIn('8','8')">8</button>
      <button class="cb" onclick="sIn('9','9')">9</button>
      <button class="cb fn" onclick="sIn('%','%')">%</button>
      <button class="cb op" onclick="sIn('*','Ã—')">Ã—</button>
      <button class="cb" onclick="sIn('4','4')">4</button>
      <button class="cb" onclick="sIn('5','5')">5</button>
      <button class="cb" onclick="sIn('6','6')">6</button>
      <button class="cb fn" onclick="sIn('**2','Â²')">xÂ²</button>
      <button class="cb op" onclick="sIn('-','-')">âˆ’</button>
      <button class="cb" onclick="sIn('1','1')">1</button>
      <button class="cb" onclick="sIn('2','2')">2</button>
      <button class="cb" onclick="sIn('3','3')">3</button>
      <button class="cb fn" onclick="sIn('**','â¿')">xâ¿</button>
      <button class="cb op" onclick="sIn('+','+')">+</button>
      <button class="cb span2" onclick="sIn('0','0')">0</button>
      <button class="cb" onclick="sIn('.','.') ">.</button>
      <button class="cb fn" onclick="sIn('Math.PI','Ï€')">Ï€</button>
      <button class="cb eq" onclick="sEval()">=</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: WHITEBOARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-draw" class="panel">
  <div class="card">
    <div class="card-title">// WHITEBOARD</div>
    <div class="toolbar">
      <button class="btn btn-c on" id="tb-pen"     onclick="setDTool('pen',this)">âœï¸ Pen</button>
      <button class="btn"          id="tb-line"    onclick="setDTool('line',this)">ğŸ“ Line</button>
      <button class="btn"          id="tb-rect"    onclick="setDTool('rect',this)">â¬œ Rect</button>
      <button class="btn"          id="tb-circle"  onclick="setDTool('circle',this)">â­• Circle</button>
      <button class="btn"          id="tb-triangle"onclick="setDTool('triangle',this)">ğŸ”º Triangle</button>
      <button class="btn"          id="tb-text"    onclick="setDTool('text',this)">T Text</button>
      <button class="btn"          id="tb-eraser"  onclick="setDTool('eraser',this)">ğŸ§¹ Eraser</button>
      <input type="color" id="dColor" value="#00f5ff" title="Color">
      <span class="size-lbl">Size:</span>
      <input type="range" id="dSize" min="1" max="40" value="3" oninput="document.getElementById('dSzLbl').textContent=this.value">
      <span id="dSzLbl" class="size-lbl">3</span>
      <button class="btn" onclick="toggleDGrid()">âŠ Grid</button>
      <button class="btn btn-p" onclick="clearDraw()">ğŸ—‘ Clear</button>
      <button class="btn btn-g" onclick="saveDraw()">ğŸ’¾ Save PNG</button>
    </div>
    <div id="drawTextRow" style="display:none;margin-bottom:8px;">
      <input type="text" id="drawTextInp" placeholder="Type text to place on canvasâ€¦">
    </div>
    <canvas id="drawCanvas" height="500"></canvas>
    <p style="margin-top:6px;font-size:.82rem;color:var(--muted);">
      Pen/Shapes: drag to draw &nbsp;|&nbsp; Text: click to place &nbsp;|&nbsp; Grid: coordinate system
    </p>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: FUNCTION GRAPHING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-graph" class="panel">
  <div class="card">
    <div class="card-title">// FUNCTION GRAPHING</div>
    <div id="funcList">
      <div class="func-row">
        <span class="func-lbl">fâ‚(x) =</span>
        <input type="text" value="x*x" placeholder="e.g. Math.sin(x), x**3-x">
        <input type="color" value="#00f5ff">
        <button class="btn btn-p" onclick="removeFuncRow(this)">âœ•</button>
      </div>
    </div>
    <div class="row mt" style="margin-bottom:10px;">
      <button class="btn" onclick="addFuncRow()">+ Add Function</button>
      <button class="btn btn-c" onclick="drawGraph()">â–¶ Draw</button>
      <button class="btn btn-p" onclick="clearGraph()">Clear</button>
    </div>
    <div class="range-row">
      <span>x min:</span><input type="number" id="gxMin" value="-10">
      <span>x max:</span><input type="number" id="gxMax" value="10">
      <span>y min:</span><input type="number" id="gyMin" value="-10">
      <span>y max:</span><input type="number" id="gyMax" value="10">
    </div>
    <canvas id="graphCanvas" height="420"></canvas>
    <p style="margin-top:6px;font-size:.82rem;color:var(--muted);">
      Available: x, Math.sin, Math.cos, Math.tan, Math.sqrt, Math.abs, Math.exp, Math.log, Math.log10, Math.PI, **
    </p>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: GEOMETRY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-geo" class="panel">
  <div class="card">
    <div class="card-title">// GEOMETRY CALCULATOR</div>
    <div class="ga" id="geoGrid">

      <div class="geo-card">
        <div class="geo-title">SQUARE</div>
        <canvas class="geo-canvas" id="geoKare" width="110" height="70"></canvas>
        <label>Side (a)</label>
        <input type="number" id="gKareA" placeholder="a" oninput="gKare()">
        <div class="geo-result" id="gKareR"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">RECTANGLE</div>
        <canvas class="geo-canvas" id="geoDik" width="110" height="70"></canvas>
        <label>Long side (a)</label>
        <input type="number" id="gDikA" placeholder="a" oninput="gDik()">
        <label>Short side (b)</label>
        <input type="number" id="gDikB" placeholder="b" oninput="gDik()">
        <div class="geo-result" id="gDikR"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">TRIANGLE</div>
        <canvas class="geo-canvas" id="geoUc" width="110" height="70"></canvas>
        <label>Base (a)</label>
        <input type="number" id="gUcA" placeholder="a" oninput="gUc()">
        <label>Height (h)</label>
        <input type="number" id="gUcH" placeholder="h" oninput="gUc()">
        <label>Sides a,b,c (optional)</label>
        <input type="text" id="gUcABC" placeholder="3,4,5" oninput="gUc()">
        <div class="geo-result" id="gUcR"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">CIRCLE</div>
        <canvas class="geo-canvas" id="geoDaire" width="110" height="70"></canvas>
        <label>Radius (r)</label>
        <input type="number" id="gDaireR" placeholder="r" oninput="gDaire()">
        <div class="geo-result" id="gDaireRes"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">PARALLELOGRAM</div>
        <canvas class="geo-canvas" id="geoPar" width="110" height="70"></canvas>
        <label>Base (a)</label>
        <input type="number" id="gParA" placeholder="a" oninput="gPar()">
        <label>Side (b)</label>
        <input type="number" id="gParB" placeholder="b" oninput="gPar()">
        <label>Height (h)</label>
        <input type="number" id="gParH" placeholder="h" oninput="gPar()">
        <div class="geo-result" id="gParR"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">TRAPEZOID</div>
        <canvas class="geo-canvas" id="geoYamuk" width="110" height="70"></canvas>
        <label>Bottom base (a)</label>
        <input type="number" id="gYamA" placeholder="a" oninput="gYamuk()">
        <label>Top base (b)</label>
        <input type="number" id="gYamB" placeholder="b" oninput="gYamuk()">
        <label>Height (h)</label>
        <input type="number" id="gYamH" placeholder="h" oninput="gYamuk()">
        <div class="geo-result" id="gYamR"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">CUBE</div>
        <canvas class="geo-canvas" id="geoKup" width="110" height="70"></canvas>
        <label>Side (a)</label>
        <input type="number" id="gKupA" placeholder="a" oninput="gKup()">
        <div class="geo-result" id="gKupR"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">CYLINDER</div>
        <canvas class="geo-canvas" id="geoSil" width="110" height="70"></canvas>
        <label>Radius (r)</label>
        <input type="number" id="gSilR" placeholder="r" oninput="gSil()">
        <label>Height (h)</label>
        <input type="number" id="gSilH" placeholder="h" oninput="gSil()">
        <div class="geo-result" id="gSilRes"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">SPHERE</div>
        <canvas class="geo-canvas" id="geoKure" width="110" height="70"></canvas>
        <label>Radius (r)</label>
        <input type="number" id="gKureR" placeholder="r" oninput="gKure()">
        <div class="geo-result" id="gKureRes"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">CONE</div>
        <canvas class="geo-canvas" id="geoKoni" width="110" height="70"></canvas>
        <label>Base radius (r)</label>
        <input type="number" id="gKoniR" placeholder="r" oninput="gKoni()">
        <label>Height (h)</label>
        <input type="number" id="gKoniH" placeholder="h" oninput="gKoni()">
        <div class="geo-result" id="gKoniRes"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">SQUARE PYRAMID</div>
        <canvas class="geo-canvas" id="geoPir" width="110" height="70"></canvas>
        <label>Base side (a)</label>
        <input type="number" id="gPirA" placeholder="a" oninput="gPir()">
        <label>Height (h)</label>
        <input type="number" id="gPirH" placeholder="h" oninput="gPir()">
        <div class="geo-result" id="gPirRes"></div>
      </div>

      <div class="geo-card">
        <div class="geo-title">PYTHAGOREAN THEOREM</div>
        <canvas class="geo-canvas" id="geoPit" width="110" height="70"></canvas>
        <label>Leg a</label>
        <input type="number" id="gPitA" placeholder="a" oninput="gPit()">
        <label>Leg b</label>
        <input type="number" id="gPitB" placeholder="b" oninput="gPit()">
        <label>Hypotenuse c (leave blank to compute)</label>
        <input type="number" id="gPitC" placeholder="c" oninput="gPit()">
        <div class="geo-result" id="gPitRes"></div>
      </div>

    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: FORMULAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-formula" class="panel">
  <div class="card">
    <div class="card-title">// FORMULA LIBRARY â€” click to copy</div>
    <div class="cat-row">
      <button class="cat-btn active" onclick="showFCat('algebra',this)">Algebra</button>
      <button class="cat-btn" onclick="showFCat('trig',this)">Trigonometry</button>
      <button class="cat-btn" onclick="showFCat('calculus',this)">Calculus</button>
      <button class="cat-btn" onclick="showFCat('integral',this)">Integration</button>
      <button class="cat-btn" onclick="showFCat('prob',this)">Probability</button>
      <button class="cat-btn" onclick="showFCat('series',this)">Series</button>
      <button class="cat-btn" onclick="showFCat('log',this)">Logarithms</button>
      <button class="cat-btn" onclick="showFCat('vectors',this)">Vectors</button>
      <button class="cat-btn" onclick="showFCat('complex',this)">Complex</button>
    </div>
    <div id="fg-algebra"  class="formula-grid show"></div>
    <div id="fg-trig"     class="formula-grid"></div>
    <div id="fg-calculus" class="formula-grid"></div>
    <div id="fg-integral" class="formula-grid"></div>
    <div id="fg-prob"     class="formula-grid"></div>
    <div id="fg-series"   class="formula-grid"></div>
    <div id="fg-log"      class="formula-grid"></div>
    <div id="fg-vectors"  class="formula-grid"></div>
    <div id="fg-complex"  class="formula-grid"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: UNIT CONVERTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-unit" class="panel">
  <div class="card">
    <div class="card-title">// UNIT CONVERTER</div>
    <div class="cat-row" id="unitCats">
      <button class="cat-btn active" onclick="setUCat('len',this)">Length</button>
      <button class="cat-btn" onclick="setUCat('area',this)">Area</button>
      <button class="cat-btn" onclick="setUCat('vol',this)">Volume</button>
      <button class="cat-btn" onclick="setUCat('mass',this)">Mass</button>
      <button class="cat-btn" onclick="setUCat('temp',this)">Temperature</button>
      <button class="cat-btn" onclick="setUCat('speed',this)">Speed</button>
      <button class="cat-btn" onclick="setUCat('angle',this)">Angle</button>
      <button class="cat-btn" onclick="setUCat('time',this)">Time</button>
      <button class="cat-btn" onclick="setUCat('energy',this)">Energy</button>
      <button class="cat-btn" onclick="setUCat('pressure',this)">Pressure</button>
    </div>
    <div class="conv-wrap" style="margin-top:14px;">
      <div>
        <label>Value</label>
        <input type="number" id="uVal" value="1" oninput="doConv()">
        <label>From</label>
        <select id="uFrom" onchange="doConv()"></select>
      </div>
      <div class="conv-arrow">â†’</div>
      <div>
        <label>Result</label>
        <div class="conv-result-val" id="uResult">â€”</div>
        <label>To</label>
        <select id="uTo" onchange="doConv()"></select>
      </div>
    </div>
    <div id="uFormula" style="margin-top:10px;font-size:.88rem;color:var(--muted);"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: MATRIX
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-matrix" class="panel">
  <div class="card">
    <div class="card-title">// MATRIX OPERATIONS</div>
    <div class="row" style="margin-bottom:14px;">
      <div>
        <label>Size</label>
        <select id="matSize" onchange="buildMat()" style="width:auto;">
          <option value="2">2Ã—2</option>
          <option value="3" selected>3Ã—3</option>
          <option value="4">4Ã—4</option>
        </select>
      </div>
      <div>
        <label>Operation</label>
        <select id="matOp" onchange="buildMat()" style="width:auto;">
          <option value="det">Determinant (A)</option>
          <option value="trace">Trace (A)</option>
          <option value="trans">Transpose (A)</option>
          <option value="inv">Inverse Aâ»Â¹</option>
          <option value="add">Addition A+B</option>
          <option value="sub">Subtraction Aâˆ’B</option>
          <option value="mul">Multiplication AÃ—B</option>
          <option value="pow">AÂ² (AÃ—A)</option>
          <option value="rank">Rank (A)</option>
        </select>
      </div>
      <div style="display:flex;align-items:flex-end;">
        <button class="btn btn-c" onclick="calcMat()">CALCULATE</button>
      </div>
    </div>
    <div class="g2">
      <div>
        <div style="font-family:var(--fpx);font-size:.52rem;color:var(--pink);margin-bottom:8px;line-height:1.8;">MATRIX A</div>
        <div class="mat-wrap"><div id="matA"></div></div>
      </div>
      <div id="matBWrap">
        <div style="font-family:var(--fpx);font-size:.52rem;color:var(--cyan);margin-bottom:8px;line-height:1.8;">MATRIX B</div>
        <div class="mat-wrap"><div id="matB"></div></div>
      </div>
    </div>
    <div class="mat-result" id="matResult">Result will appear hereâ€¦</div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: NUMBER THEORY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-numth" class="panel">
  <div class="card">
    <div class="card-title">// NUMBER THEORY</div>
    <div class="g2">

      <div class="nt-card">
        <div class="nt-title">PRIME CHECK</div>
        <input type="number" id="ntPrime" placeholder="Enter a numberâ€¦" oninput="ntCheckPrime()">
        <div class="result" id="ntPrimeR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">GCD / LCM</div>
        <input type="text" id="ntGcd" placeholder="e.g. 12, 18, 24" oninput="ntGcdLcm()">
        <div class="result" id="ntGcdR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">PRIME FACTORIZATION</div>
        <input type="number" id="ntFact" placeholder="Enter a numberâ€¦" oninput="ntFactorize()">
        <div class="result" id="ntFactR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">FACTORIAL n!</div>
        <input type="number" id="ntFacN" placeholder="n (0 â€“ 170)" oninput="ntFactorial()">
        <div class="result" id="ntFacR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">FIBONACCI SEQUENCE</div>
        <input type="number" id="ntFib" placeholder="First n terms (max 60)" oninput="ntFib()">
        <div class="result" id="ntFibR" style="font-size:1rem;word-break:break-all;"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">BASE CONVERTER</div>
        <input type="text" id="ntBNum" placeholder="Enter numberâ€¦" oninput="ntBase()">
        <div class="row mt">
          <select id="ntBFrom" onchange="ntBase()" style="width:auto;">
            <option value="10">Decimal (10)</option>
            <option value="2">Binary (2)</option>
            <option value="8">Octal (8)</option>
            <option value="16">Hex (16)</option>
          </select>
          <span style="color:var(--pink);padding:8px 4px;">â†’</span>
          <select id="ntBTo" onchange="ntBase()" style="width:auto;">
            <option value="2">Binary (2)</option>
            <option value="8">Octal (8)</option>
            <option value="10" selected>Decimal (10)</option>
            <option value="16">Hex (16)</option>
          </select>
        </div>
        <div class="result" id="ntBRes"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">EUCLIDEAN ALGORITHM (step-by-step)</div>
        <div class="row">
          <input type="number" id="ntEA" placeholder="a">
          <input type="number" id="ntEB" placeholder="b">
          <button class="btn btn-c" onclick="ntEuclid()" style="white-space:nowrap">Show</button>
        </div>
        <div class="result" id="ntEuclidR" style="font-size:.95rem;"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">EULER TOTIENT Ï†(n) &amp; DIVISORS</div>
        <input type="number" id="ntPhi" placeholder="Enter nâ€¦" oninput="ntPhi()">
        <div class="result" id="ntPhiR"></div>
      </div>

    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: STATISTICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-stat" class="panel">
  <div class="card">
    <div class="card-title">// STATISTICAL ANALYSIS</div>
    <label>Data set (comma or space separated)</label>
    <div class="row mt">
      <input type="text" id="statData" value="4, 7, 2, 9, 3, 11, 5, 8, 6, 10" placeholder="e.g. 1, 3, 5, 7, 9">
      <button class="btn btn-c" onclick="calcStat()" style="white-space:nowrap">ANALYZE</button>
    </div>
    <div class="stat-grid" id="statGrid"></div>
    <canvas id="statChart" height="200"></canvas>

    <hr>
    <div class="card-title" style="margin-top:8px;">// LINEAR REGRESSION</div>
    <label>X values (comma separated)</label>
    <input type="text" id="regX" value="1,2,3,4,5">
    <label>Y values (comma separated)</label>
    <input type="text" id="regY" value="2.2,4.1,5.9,8.2,9.8">
    <button class="btn btn-c mt" onclick="calcReg()">Calculate Regression</button>
    <div class="result" id="regResult"></div>
    <canvas id="regChart" height="200"></canvas>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: EQUATION SOLVER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-equation" class="panel">
  <div class="card">
    <div class="card-title">// EQUATION SOLVER</div>
    <div class="cat-row">
      <button class="cat-btn active" onclick="showEq('lin',this)">1st Degree</button>
      <button class="cat-btn" onclick="showEq('quad',this)">2nd Degree</button>
      <button class="cat-btn" onclick="showEq('cubic',this)">3rd Degree</button>
      <button class="cat-btn" onclick="showEq('sys2',this)">2Ã—2 System</button>
      <button class="cat-btn" onclick="showEq('sys3',this)">3Ã—3 System</button>
      <button class="cat-btn" onclick="showEq('nraph',this)">Numerical</button>
    </div>

    <div id="eq-lin" class="eq-panel active">
      <p class="eq-hint">ax + b = 0  â†’  x = âˆ’b / a</p>
      <div class="g2">
        <div><label>a (coefficient)</label><input type="number" id="eLA" value="2"></div>
        <div><label>b (constant)</label>  <input type="number" id="eLB" value="-6"></div>
      </div>
      <button class="btn btn-c mt" onclick="solveLinear()">SOLVE</button>
      <div class="result" id="eLinR"></div>
    </div>

    <div id="eq-quad" class="eq-panel">
      <p class="eq-hint">axÂ² + bx + c = 0  â†’  quadratic formula</p>
      <div class="g3">
        <div><label>a</label><input type="number" id="eQA" value="1"></div>
        <div><label>b</label><input type="number" id="eQB" value="-5"></div>
        <div><label>c</label><input type="number" id="eQC" value="6"></div>
      </div>
      <button class="btn btn-c mt" onclick="solveQuad()">SOLVE</button>
      <div class="result" id="eQuadR"></div>
    </div>

    <div id="eq-cubic" class="eq-panel">
      <p class="eq-hint">axÂ³ + bxÂ² + cx + d = 0  â†’  numerical roots</p>
      <div class="g2">
        <div><label>a</label><input type="number" id="eCuA" value="1"></div>
        <div><label>b</label><input type="number" id="eCuB" value="-6"></div>
        <div><label>c</label><input type="number" id="eCuC" value="11"></div>
        <div><label>d</label><input type="number" id="eCuD" value="-6"></div>
      </div>
      <button class="btn btn-c mt" onclick="solveCubic()">SOLVE</button>
      <div class="result" id="eCubicR"></div>
    </div>

    <div id="eq-sys2" class="eq-panel">
      <p class="eq-hint">aâ‚x + bâ‚y = câ‚  &nbsp;|&nbsp;  aâ‚‚x + bâ‚‚y = câ‚‚</p>
      <div class="g2">
        <div><label>aâ‚</label><input type="number" id="s2A1" value="2"></div>
        <div><label>bâ‚</label><input type="number" id="s2B1" value="3"></div>
        <div><label>câ‚</label><input type="number" id="s2C1" value="8"></div>
        <div><label>aâ‚‚</label><input type="number" id="s2A2" value="1"></div>
        <div><label>bâ‚‚</label><input type="number" id="s2B2" value="-1"></div>
        <div><label>câ‚‚</label><input type="number" id="s2C2" value="1"></div>
      </div>
      <button class="btn btn-c mt" onclick="solveSys2()">SOLVE</button>
      <div class="result" id="eSys2R"></div>
    </div>

    <div id="eq-sys3" class="eq-panel">
      <p class="eq-hint">3 equations, 3 unknowns (Gaussian elimination)</p>
      <div class="g3">
        <div><label>aâ‚</label><input type="number" id="s3A1" value="2"></div>
        <div><label>bâ‚</label><input type="number" id="s3B1" value="1"></div>
        <div><label>câ‚</label><input type="number" id="s3C1" value="-1"></div>
        <div><label>dâ‚ (RHS)</label><input type="number" id="s3D1" value="8"></div>
        <div><label>aâ‚‚</label><input type="number" id="s3A2" value="-3"></div>
        <div><label>bâ‚‚</label><input type="number" id="s3B2" value="-1"></div>
        <div><label>câ‚‚</label><input type="number" id="s3C2" value="2"></div>
        <div><label>dâ‚‚ (RHS)</label><input type="number" id="s3D2" value="-11"></div>
        <div><label>aâ‚ƒ</label><input type="number" id="s3A3" value="-2"></div>
        <div><label>bâ‚ƒ</label><input type="number" id="s3B3" value="1"></div>
        <div><label>câ‚ƒ</label><input type="number" id="s3C3" value="2"></div>
        <div><label>dâ‚ƒ (RHS)</label><input type="number" id="s3D3" value="-3"></div>
      </div>
      <button class="btn btn-c mt" onclick="solveSys3()">SOLVE</button>
      <div class="result" id="eSys3R"></div>
    </div>

    <div id="eq-nraph" class="eq-panel">
      <p class="eq-hint">f(x) = 0  â†’  Newton-Raphson numerical method</p>
      <label>f(x) expression (e.g. Math.exp(x)-5, Math.log(x)-2, x**3-2)</label>
      <input type="text" id="eNRF" value="Math.exp(x)-5">
      <label>Initial guess xâ‚€</label>
      <input type="number" id="eNRX0" value="1">
      <button class="btn btn-c mt" onclick="solveNewton()">NEWTON-RAPHSON</button>
      <div class="result" id="eNRR"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PANEL: FRACTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-fraction" class="panel">
  <div class="card">
    <div class="card-title">// FRACTION OPERATIONS</div>
    <div class="g2">

      <div class="nt-card">
        <div class="nt-title">SIMPLIFY</div>
        <div class="g2">
          <div><label>Numerator</label>  <input type="number" id="fSimN" value="12"></div>
          <div><label>Denominator</label><input type="number" id="fSimD" value="18"></div>
        </div>
        <button class="btn btn-c mt" onclick="simplifyFrac()">Simplify</button>
        <div class="result" id="fSimR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">ADDITION</div>
        <div class="g2">
          <div><label>Numâ‚</label><input type="number" id="fAN1" value="1"></div>
          <div><label>Denâ‚</label><input type="number" id="fAD1" value="3"></div>
          <div><label>Numâ‚‚</label><input type="number" id="fAN2" value="1"></div>
          <div><label>Denâ‚‚</label><input type="number" id="fAD2" value="4"></div>
        </div>
        <button class="btn btn-c mt" onclick="addFrac()">Add</button>
        <div class="result" id="fAddR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">SUBTRACTION</div>
        <div class="g2">
          <div><label>Numâ‚</label><input type="number" id="fSN1" value="3"></div>
          <div><label>Denâ‚</label><input type="number" id="fSD1" value="4"></div>
          <div><label>Numâ‚‚</label><input type="number" id="fSN2" value="1"></div>
          <div><label>Denâ‚‚</label><input type="number" id="fSD2" value="6"></div>
        </div>
        <button class="btn btn-c mt" onclick="subFrac()">Subtract</button>
        <div class="result" id="fSubR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">MULTIPLICATION</div>
        <div class="g2">
          <div><label>Numâ‚</label><input type="number" id="fMN1" value="2"></div>
          <div><label>Denâ‚</label><input type="number" id="fMD1" value="3"></div>
          <div><label>Numâ‚‚</label><input type="number" id="fMN2" value="3"></div>
          <div><label>Denâ‚‚</label><input type="number" id="fMD2" value="5"></div>
        </div>
        <button class="btn btn-c mt" onclick="mulFrac()">Multiply</button>
        <div class="result" id="fMulR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">DIVISION</div>
        <div class="g2">
          <div><label>Numâ‚</label><input type="number" id="fDivN1" value="4"></div>
          <div><label>Denâ‚</label><input type="number" id="fDivD1" value="5"></div>
          <div><label>Numâ‚‚</label><input type="number" id="fDivN2" value="2"></div>
          <div><label>Denâ‚‚</label><input type="number" id="fDivD2" value="3"></div>
        </div>
        <button class="btn btn-c mt" onclick="divFrac()">Divide</button>
        <div class="result" id="fDivR"></div>
      </div>

      <div class="nt-card">
        <div class="nt-title">DECIMAL â†” FRACTION</div>
        <label>Decimal number</label>
        <input type="number" id="fDecInp" step="any" placeholder="e.g. 0.75">
        <button class="btn btn-c mt" onclick="decToFrac()">Convert to Fraction</button>
        <div class="result" id="fDecR"></div>
      </div>

    </div>
  </div>
</div>

</main>

<!-- â•â• COMMUNITY SECTION â•â• -->
<section class="community" aria-label="Community and Token Support">
  <div class="community-title">// SUPPORT $MATHEMATICS â€” MORE THAN JUST A TOKEN</div>

  <div class="quotes-grid">

    <div class="quote-card">
      <span class="quote-mark">"</span>
      <div class="quote-text">This is a free math tool built for students everywhere. If you find it useful, show your support.</div>
      <span class="quote-tag">// FOR STUDENTS</span>
    </div>

    <div class="quote-card">
      <span class="quote-mark">"</span>
      <div class="quote-text">We didn't promise moonshots. We built something real first â€” a working app that people actually use. $MATHEMATICS is backed by a product, not just a dream.</div>
      <span class="quote-tag">// PRODUCT FIRST</span>
    </div>

    <div class="quote-card">
      <span class="quote-mark">"</span>
      <div class="quote-text">Every great project starts somewhere small. If you believe math education should be accessible to all â€” open source, ad-free, forever â€” this is worth a few dollars of support.</div>
      <span class="quote-tag">// OPEN SOURCE BELIEF</span>
    </div>

    <div class="quote-card">
      <span class="quote-mark">"</span>
      <div class="quote-text">We're asking you to be part of something meaningful. A community that values knowledge, learning, and building in public.</div>
      <span class="quote-tag">// COMMUNITY MATTERS</span>
    </div>

    <div class="quote-card">
      <span class="quote-mark">"</span>
      <div class="quote-text">Most tokens have nothing behind them. $MATHEMATICS has 12 working tools, 100+ formulas, a graphing engine, and a pixel mascot. The work is already done â€” and it's free for everyone.</div>
      <span class="quote-tag">// REAL UTILITY</span>
    </div>

    <div class="quote-card">
      <span class="quote-mark">"</span>
      <div class="quote-text">You don't need to be a trader to support this. Share the site with a student who needs it. That's worth more than any buy order.</div>
      <span class="quote-tag">// SHARE THE KNOWLEDGE</span>
    </div>

  </div>

  <!-- Bottom CTA repeat -->
  <div class="cta-wrap">
    <a href="https://pump.fun/coin/mathematics" target="_blank" rel="noopener noreferrer" class="cta-btn cta-pump">
      <span class="cta-icon">ğŸš€</span> BUY $MATHS on pump.fun
    </a>
    <a href="https://x.com/MathsCoin" target="_blank" rel="noopener noreferrer" class="cta-btn cta-twitter">
      <span class="cta-icon">ğ•</span> Follow on X
    </a>
  </div>

  <div class="contract-note">
    No financial advice. Cryptocurrency involves risk â€” only invest what you can afford to lose.<br>
    $MATHEMATICS is a community project. This web app is free, open source, and always will be.
  </div>

  <div class="ticker-tape">$MATHS // MATH FOR ALL // OPEN SOURCE // FREE FOREVER // PUMP.FUN // $MATHS</div>
</section>

<footer>
  <div class="foot-title">$MATHS TOKEN â€” PUMP.FUN</div>
  <div class="foot-sub">Â© 2026 MATHEMATICS // MIT LICENSE // OPEN SOURCE // FREE FOR ALL STUDENTS</div>
</footer>

</div><!-- #app -->
<div id="toast">âœ“ COPIED!</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT â€” All original code, no external libraries
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
'use strict';

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   PIXEL MASCOT â€” Original pixel art
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
(function(){
  const c = document.getElementById('mascotCanvas');
  if(!c) return;
  const ctx = c.getContext('2d');
  const P = 8;
  // Color palette
  const K = { _:null, A:'#9b59ff', B:'#7a3fd4', C:'#00f5ff', Y:'#ffe600', G:'#39ff14', R:'#ff2d78', W:'#ffffff', D:'#1a0a2e' };
  // 16Ã—16 sprite
  const S = [
    '_____AAAAAAA_____','____BBBBBBBBB____','___BBBBBBBBBBB___',
    '__BBYYBBBBYYBB___','__BBYYBBBBYYBB___','__BBBBBBBBBBB____',
    '__BBRBBWWWWBB____','__BBBWWWWWWBB____','__BBBBBBBBBBB____',
    'CBBAACBBBBBAACC__','CCCCBBBBBBBBCCC__','__CCCBBBBBBCCC___',
    '___BBBBBBBBBB____','___GBBBBBBBBBG___','___GBBBBBBBBBG___',
    '___GGGGGGGGGGG___'
  ];
  let frame = 0, shake = 0;
  c.addEventListener('click', () => { shake = 18; });
  function draw() {
    ctx.clearRect(0,0,128,128);
    const bob = Math.round(Math.sin(frame * 0.055) * 2);
    const sx  = shake > 0 ? (Math.random()-.5)*3|0 : 0;
    if(shake > 0) shake--;
    S.forEach((row, y) => {
      [...row].forEach((ch, x) => {
        const col = K[ch]; if(!col) return;
        ctx.fillStyle = col;
        ctx.fillRect(x*P + sx, y*P + bob, P, P);
      });
    });
    if(frame % 90 < 3) {
      ctx.fillStyle = K.D;
      ctx.fillRect(3*P + sx, 3*P + bob, 2*P, P);
      ctx.fillRect(9*P + sx, 3*P + bob, 2*P, P);
    }
    frame++;
    requestAnimationFrame(draw);
  }
  draw();
})();

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   NAVIGATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.getElementById('mainNav').addEventListener('click', e => {
  const btn = e.target.closest('.nav-btn');
  if(!btn) return;
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  btn.classList.add('active');
  document.getElementById('panel-' + btn.dataset.panel).classList.add('active');
  const p = btn.dataset.panel;
  if(p === 'draw')   { initDraw(); }
  if(p === 'graph')  { resizeC('graphCanvas'); drawGraph(); }
  if(p === 'geo')    { initGeoShapes(); }
  if(p === 'stat')   { resizeC('statChart'); resizeC('regChart'); }
  if(p === 'matrix') { buildMat(); }
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   TOAST
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function toast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg || 'âœ“ COPIED!';
  t.style.display = 'block';
  clearTimeout(t._tid);
  t._tid = setTimeout(() => { t.style.display = 'none'; }, 1800);
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   BASIC CALCULATOR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let cExpr = '', cJust = false;

function cIn(v) {
  if(cJust) { cExpr = ''; cJust = false; }
  cExpr += v;
  document.getElementById('cVal').textContent = cExpr || '0';
}
function cAC() {
  cExpr = '';
  document.getElementById('cVal').textContent = '0';
  document.getElementById('cExpr').textContent = '';
}
function cDel() {
  cExpr = cExpr.slice(0,-1);
  document.getElementById('cVal').textContent = cExpr || '0';
}
function cEval() {
  if(!cExpr) return;
  try {
    document.getElementById('cExpr').textContent = cExpr + ' =';
    const r = Function('"use strict";return(' + cExpr + ')')();
    const d = isFinite(r) ? (+r.toPrecision(12)).toString() : r.toString();
    document.getElementById('cVal').textContent = d;
    cExpr = d; cJust = true;
  } catch(e) {
    document.getElementById('cVal').textContent = 'ERROR';
    cExpr = '';
  }
}
// Keyboard support
document.addEventListener('keydown', e => {
  if(!document.getElementById('panel-calc').classList.contains('active')) return;
  if(e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
  const k = e.key;
  if('0123456789.+-*/()'.includes(k)) { e.preventDefault(); cIn(k); }
  if(k === 'Enter')     { e.preventDefault(); cEval(); }
  if(k === 'Backspace') { e.preventDefault(); cDel(); }
  if(k === 'Escape')    { e.preventDefault(); cAC(); }
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   SCIENTIFIC CALCULATOR
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let sCode = '', sDisp = '', sJust = false;

function sIn(code, disp) {
  if(sJust) { sCode = ''; sDisp = ''; sJust = false; }
  sCode += code; sDisp += disp;
  document.getElementById('sVal').textContent = sDisp || '0';
}
function sWrap(pre, post, dpre, dpost) {
  if(sJust) { sJust = false; }
  sCode = pre + sCode + post;
  sDisp = dpre + sDisp + (dpost || ')');
  document.getElementById('sVal').textContent = sDisp || '0';
}
function sAC() {
  sCode = ''; sDisp = '';
  document.getElementById('sVal').textContent = '0';
  document.getElementById('sExpr').textContent = '';
}
function sDel() { sCode = sCode.slice(0,-1); sDisp = sDisp.slice(0,-1); document.getElementById('sVal').textContent = sDisp || '0'; }
function sDeg() { sCode += '*(Math.PI/180)'; sDisp += 'Ã—(Ï€/180)'; document.getElementById('sVal').textContent = sDisp; }
function sRad() { sCode += '*(180/Math.PI)'; sDisp += 'Ã—(180/Ï€)'; document.getElementById('sVal').textContent = sDisp; }
function sEval() {
  if(!sCode) return;
  try {
    document.getElementById('sExpr').textContent = sDisp + ' =';
    const r = Function('"use strict";return(' + sCode + ')')();
    const d = isFinite(r) ? (+r.toPrecision(12)).toString() : r.toString();
    document.getElementById('sVal').textContent = d;
    sCode = d; sDisp = d; sJust = true;
  } catch(e) {
    document.getElementById('sVal').textContent = 'ERROR';
    sCode = ''; sDisp = '';
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   WHITEBOARD / DRAW
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let dCtx, dCanvas, dTool = 'pen', dDown = false, dSX = 0, dSY = 0, dSnap = null, dGridOn = false;

function initDraw() {
  dCanvas = document.getElementById('drawCanvas');
  if(dCanvas._ready) return;
  dCanvas._ready = true;
  dCanvas.width  = dCanvas.offsetWidth || 800;
  dCanvas.height = 500;
  dCtx = dCanvas.getContext('2d');
  fillBg();

  const getP = e => {
    const r = dCanvas.getBoundingClientRect();
    const sx = dCanvas.width / r.width, sy = dCanvas.height / r.height;
    const src = e.touches ? e.touches[0] : e;
    return { x:(src.clientX - r.left)*sx, y:(src.clientY - r.top)*sy };
  };
  const onStart = e => {
    e.preventDefault();
    if(dTool === 'text') {
      const p = getP(e);
      const txt = document.getElementById('drawTextInp').value || 'Text';
      dCtx.fillStyle = document.getElementById('dColor').value;
      dCtx.font = Math.max(16, parseInt(document.getElementById('dSize').value)*5) + "px 'Share Tech Mono', monospace";
      dCtx.fillText(txt, p.x, p.y);
      return;
    }
    dDown = true;
    const p = getP(e);
    dSX = p.x; dSY = p.y;
    dSnap = dCtx.getImageData(0,0,dCanvas.width, dCanvas.height);
    if(dTool === 'pen' || dTool === 'eraser') {
      dCtx.beginPath(); dCtx.moveTo(dSX, dSY);
    }
  };
  const onMove = e => {
    if(!dDown) return; e.preventDefault();
    const p  = getP(e);
    const sz = parseInt(document.getElementById('dSize').value);
    const cl = document.getElementById('dColor').value;
    if(dTool === 'pen') {
      dCtx.lineWidth = sz; dCtx.strokeStyle = cl; dCtx.lineCap = 'round'; dCtx.lineJoin = 'round';
      dCtx.lineTo(p.x, p.y); dCtx.stroke();
    } else if(dTool === 'eraser') {
      dCtx.lineWidth = sz*4; dCtx.strokeStyle = '#040010'; dCtx.lineCap = 'round';
      dCtx.lineTo(p.x, p.y); dCtx.stroke();
    } else {
      dCtx.putImageData(dSnap, 0, 0);
      dCtx.strokeStyle = cl; dCtx.lineWidth = sz;
      if(dTool === 'line') {
        dCtx.beginPath(); dCtx.moveTo(dSX, dSY); dCtx.lineTo(p.x, p.y); dCtx.stroke();
      } else if(dTool === 'rect') {
        dCtx.strokeRect(dSX, dSY, p.x-dSX, p.y-dSY);
      } else if(dTool === 'circle') {
        const r = Math.hypot(p.x-dSX, p.y-dSY);
        dCtx.beginPath(); dCtx.arc(dSX, dSY, r, 0, Math.PI*2); dCtx.stroke();
      } else if(dTool === 'triangle') {
        dCtx.beginPath();
        dCtx.moveTo((dSX+p.x)/2, dSY);
        dCtx.lineTo(p.x, p.y);
        dCtx.lineTo(dSX, p.y);
        dCtx.closePath(); dCtx.stroke();
      }
    }
  };
  const onEnd = () => { dDown = false; };
  dCanvas.addEventListener('mousedown',  onStart);
  dCanvas.addEventListener('mousemove',  onMove);
  dCanvas.addEventListener('mouseup',    onEnd);
  dCanvas.addEventListener('mouseleave', onEnd);
  dCanvas.addEventListener('touchstart', onStart, {passive:false});
  dCanvas.addEventListener('touchmove',  onMove,  {passive:false});
  dCanvas.addEventListener('touchend',   onEnd);
}
function fillBg() {
  if(!dCtx) return;
  dCtx.fillStyle = '#040010';
  dCtx.fillRect(0, 0, dCanvas.width, dCanvas.height);
  if(dGridOn) drawDGrid();
}
function drawDGrid() {
  dCtx.strokeStyle = 'rgba(155,89,255,0.18)'; dCtx.lineWidth = .5;
  for(let x=0; x<dCanvas.width; x+=40) { dCtx.beginPath(); dCtx.moveTo(x,0); dCtx.lineTo(x,dCanvas.height); dCtx.stroke(); }
  for(let y=0; y<dCanvas.height; y+=40) { dCtx.beginPath(); dCtx.moveTo(0,y); dCtx.lineTo(dCanvas.width,y); dCtx.stroke(); }
  const cx = dCanvas.width/2, cy = dCanvas.height/2;
  dCtx.strokeStyle = 'rgba(0,245,255,0.35)'; dCtx.lineWidth = 1;
  dCtx.beginPath(); dCtx.moveTo(cx,0); dCtx.lineTo(cx,dCanvas.height); dCtx.stroke();
  dCtx.beginPath(); dCtx.moveTo(0,cy); dCtx.lineTo(dCanvas.width,cy); dCtx.stroke();
}
function setDTool(t, el) {
  dTool = t;
  document.querySelectorAll('#panel-draw .btn').forEach(b => b.classList.remove('on','btn-c'));
  el.classList.add('on','btn-c');
  document.getElementById('drawTextRow').style.display = t === 'text' ? 'flex' : 'none';
}
function toggleDGrid() { dGridOn = !dGridOn; if(dGridOn) drawDGrid(); }
function clearDraw()   { if(!dCtx) return; fillBg(); }
function saveDraw()    { const a = document.createElement('a'); a.href = dCanvas.toDataURL('image/png'); a.download = 'mathematics-draw.png'; a.click(); }

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   GRAPHING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const FC = ['#00f5ff','#ff2d78','#39ff14','#ffe600','#9b59ff','#ff8c00','#ff00ff'];
let fcIdx = 1;

function addFuncRow() {
  const col = FC[fcIdx++ % FC.length];
  const row = document.createElement('div');
  row.className = 'func-row';
  row.innerHTML =
    `<span class="func-lbl">f${fcIdx}(x)=</span>
     <input type="text" value="Math.sin(x)" placeholder="Enter expressionâ€¦">
     <input type="color" value="${col}">
     <button class="btn btn-p" onclick="removeFuncRow(this)">âœ•</button>`;
  document.getElementById('funcList').appendChild(row);
}
function removeFuncRow(btn) { btn.closest('.func-row').remove(); drawGraph(); }

function resizeC(id) {
  const c = document.getElementById(id);
  if(!c) return;
  c.width = c.offsetWidth || c.parentElement?.offsetWidth || 600;
}

function drawGraph() {
  const canvas = document.getElementById('graphCanvas');
  resizeC('graphCanvas');
  const W = canvas.width, H = canvas.height || 420;
  canvas.height = H;
  const ctx = canvas.getContext('2d');

  const xMin = parseFloat(document.getElementById('gxMin').value) || -10;
  const xMax = parseFloat(document.getElementById('gxMax').value) || 10;
  const yMin = parseFloat(document.getElementById('gyMin').value) || -10;
  const yMax = parseFloat(document.getElementById('gyMax').value) || 10;
  if(xMin >= xMax || yMin >= yMax) return;

  ctx.fillStyle = '#030010'; ctx.fillRect(0,0,W,H);

  // Grid lines
  ctx.strokeStyle = 'rgba(155,89,255,0.12)'; ctx.lineWidth = .5;
  for(let i = Math.ceil(xMin); i <= Math.floor(xMax); i++) {
    const px = (i-xMin)/(xMax-xMin)*W;
    ctx.beginPath(); ctx.moveTo(px,0); ctx.lineTo(px,H); ctx.stroke();
  }
  for(let j = Math.ceil(yMin); j <= Math.floor(yMax); j++) {
    const py = H-(j-yMin)/(yMax-yMin)*H;
    ctx.beginPath(); ctx.moveTo(0,py); ctx.lineTo(W,py); ctx.stroke();
  }

  // Axes
  const ox = Math.max(0,Math.min(W,-xMin/(xMax-xMin)*W));
  const oy = Math.max(0,Math.min(H,H+yMin/(yMax-yMin)*H));
  ctx.strokeStyle = 'rgba(0,245,255,0.5)'; ctx.lineWidth = 1;
  ctx.beginPath(); ctx.moveTo(ox,0); ctx.lineTo(ox,H); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(0,oy); ctx.lineTo(W,oy); ctx.stroke();

  // Labels
  ctx.fillStyle = 'rgba(0,245,255,0.55)'; ctx.font = '10px Share Tech Mono';
  for(let i = Math.ceil(xMin); i <= Math.floor(xMax); i++) {
    if(i===0) continue;
    ctx.fillText(i, (i-xMin)/(xMax-xMin)*W+2, Math.min(H-2, oy+12));
  }
  for(let j = Math.ceil(yMin); j <= Math.floor(yMax); j++) {
    if(j===0) continue;
    ctx.fillText(j, Math.max(2, ox+3), H-(j-yMin)/(yMax-yMin)*H-2);
  }

  // Plot functions
  document.querySelectorAll('#funcList .func-row').forEach(row => {
    const expr  = row.querySelector('input[type=text]')?.value;
    const color = row.querySelector('input[type=color]')?.value || '#00f5ff';
    if(!expr) return;
    ctx.strokeStyle = color; ctx.lineWidth = 2;
    ctx.shadowColor = color; ctx.shadowBlur = 5;
    ctx.beginPath();
    let pen = false;
    const steps = W * 2;
    for(let px = 0; px <= steps; px++) {
      const x = xMin + (px/steps)*(xMax-xMin);
      let y;
      try { y = Function('"use strict";const x='+x+';return '+expr)(); } catch { pen=false; continue; }
      if(!isFinite(y) || isNaN(y)) { pen=false; continue; }
      const sy = H-(y-yMin)/(yMax-yMin)*H;
      if(!pen) { ctx.moveTo(px/steps*W, sy); pen=true; } else { ctx.lineTo(px/steps*W, sy); }
    }
    ctx.stroke(); ctx.shadowBlur = 0;
  });
}

function clearGraph() {
  const canvas = document.getElementById('graphCanvas');
  const ctx = canvas.getContext('2d');
  ctx.fillStyle = '#030010'; ctx.fillRect(0,0,canvas.width,canvas.height);
  // Reset to one row
  document.getElementById('funcList').innerHTML =
    `<div class="func-row">
      <span class="func-lbl">fâ‚(x) =</span>
      <input type="text" value="x*x" placeholder="e.g. Math.sin(x), x**3-x">
      <input type="color" value="#00f5ff">
      <button class="btn btn-p" onclick="removeFuncRow(this)">âœ•</button>
    </div>`;
  fcIdx = 1;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   GEOMETRY â€” helpers
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const fp = n => (isNaN(n)||!isFinite(n)) ? 'â€”' : (+n.toPrecision(8)).toString();

function geoC(id, fn) {
  const c = document.getElementById(id); if(!c) return;
  const ctx = c.getContext('2d');
  ctx.fillStyle = '#050010'; ctx.fillRect(0,0,c.width,c.height);
  fn(ctx, c.width, c.height);
}

function initGeoShapes() {
  geoC('geoKare',  (c,w,h)=>{ c.strokeStyle='#9b59ff'; c.lineWidth=1.5; c.strokeRect(10,10,w-20,h-20); });
  geoC('geoDik',   (c,w,h)=>{ c.strokeStyle='#00f5ff'; c.lineWidth=1.5; c.strokeRect(5,15,w-10,h-30); });
  geoC('geoUc',    (c,w,h)=>{ c.strokeStyle='#ff2d78'; c.lineWidth=1.5; c.beginPath(); c.moveTo(w/2,5); c.lineTo(w-5,h-5); c.lineTo(5,h-5); c.closePath(); c.stroke(); });
  geoC('geoDaire', (c,w,h)=>{ c.strokeStyle='#39ff14'; c.lineWidth=1.5; c.beginPath(); c.arc(w/2,h/2,Math.min(w,h)/2-6,0,Math.PI*2); c.stroke(); });
  geoC('geoPar',   (c,w,h)=>{ c.strokeStyle='#ffe600'; c.lineWidth=1.5; c.beginPath(); c.moveTo(15,5); c.lineTo(w-5,5); c.lineTo(w-15,h-5); c.lineTo(5,h-5); c.closePath(); c.stroke(); });
  geoC('geoYamuk', (c,w,h)=>{ c.strokeStyle='#9b59ff'; c.lineWidth=1.5; c.beginPath(); c.moveTo(20,10); c.lineTo(w-20,10); c.lineTo(w-5,h-5); c.lineTo(5,h-5); c.closePath(); c.stroke(); });
  geoC('geoKup',   (c,w,h)=>{ c.strokeStyle='#ffe600'; c.lineWidth=1.5; c.strokeRect(5,15,w-25,h-20); c.strokeRect(15,5,w-25,h-20); c.beginPath(); c.moveTo(5,15); c.lineTo(15,5); c.moveTo(w-20,15); c.lineTo(w-10,5); c.moveTo(5,h-5); c.lineTo(15,h-15); c.moveTo(w-20,h-5); c.lineTo(w-10,h-15); c.stroke(); });
  geoC('geoSil',   (c,w,h)=>{ c.strokeStyle='#9b59ff'; c.lineWidth=1.5; c.strokeRect(15,20,w-30,h-30); c.beginPath(); c.ellipse(w/2,20,w/2-15,10,0,0,Math.PI*2); c.stroke(); });
  geoC('geoKure',  (c,w,h)=>{ c.strokeStyle='#00f5ff'; c.lineWidth=1.5; c.beginPath(); c.arc(w/2,h/2,Math.min(w,h)/2-6,0,Math.PI*2); c.stroke(); c.beginPath(); c.ellipse(w/2,h/2,Math.min(w,h)/2-6,10,0,0,Math.PI*2); c.stroke(); });
  geoC('geoKoni',  (c,w,h)=>{ c.strokeStyle='#ff2d78'; c.lineWidth=1.5; c.beginPath(); c.ellipse(w/2,h-12,w/2-8,8,0,0,Math.PI*2); c.stroke(); c.beginPath(); c.moveTo(8,h-12); c.lineTo(w/2,5); c.lineTo(w-8,h-12); c.stroke(); });
  geoC('geoPir',   (c,w,h)=>{ c.strokeStyle='#ffe600'; c.lineWidth=1.5; c.strokeRect(10,h/2,w-20,h/2-8); c.beginPath(); c.moveTo(10,h/2); c.lineTo(w/2,5); c.moveTo(w-10,h/2); c.lineTo(w/2,5); c.moveTo(w-10,h-8); c.lineTo(w/2,5); c.stroke(); });
  geoC('geoPit',   (c,w,h)=>{ c.strokeStyle='#ff2d78'; c.lineWidth=1.5; c.beginPath(); c.moveTo(5,h-5); c.lineTo(w-5,h-5); c.lineTo(5,5); c.closePath(); c.stroke(); c.strokeRect(5,h-17,12,12); });
}

function gKare()  { const a=+document.getElementById('gKareA').value; if(!a||a<0) return; document.getElementById('gKareR').textContent=`Area: ${fp(a*a)}\nPerimeter: ${fp(4*a)}\nDiagonal: ${fp(a*Math.SQRT2)}`; }
function gDik()   { const a=+document.getElementById('gDikA').value, b=+document.getElementById('gDikB').value; if(!a||!b) return; document.getElementById('gDikR').textContent=`Area: ${fp(a*b)}\nPerimeter: ${fp(2*(a+b))}\nDiagonal: ${fp(Math.hypot(a,b))}`; }
function gUc()    {
  const a=+document.getElementById('gUcA').value, h=+document.getElementById('gUcH').value;
  const abc=document.getElementById('gUcABC').value.split(',').map(Number).filter(n=>n>0&&isFinite(n));
  let t='';
  if(a&&h) t+=`Area: ${fp(0.5*a*h)}\n`;
  if(abc.length===3){ const s=(abc[0]+abc[1]+abc[2])/2; const A=Math.sqrt(s*(s-abc[0])*(s-abc[1])*(s-abc[2])); t+=`Heron Area: ${fp(A)}\nPerimeter: ${fp(abc[0]+abc[1]+abc[2])}`; }
  document.getElementById('gUcR').textContent=t;
}
function gDaire() { const r=+document.getElementById('gDaireR').value; if(!r||r<0) return; document.getElementById('gDaireRes').textContent=`Area: ${fp(Math.PI*r*r)}\nCircumference: ${fp(2*Math.PI*r)}`; }
function gPar()   { const a=+document.getElementById('gParA').value, b=+document.getElementById('gParB').value, h=+document.getElementById('gParH').value; if(!a) return; let t=`Perimeter: ${fp(2*(a+b))}`; if(h) t+=`\nArea: ${fp(a*h)}`; document.getElementById('gParR').textContent=t; }
function gYamuk() { const a=+document.getElementById('gYamA').value, b=+document.getElementById('gYamB').value, h=+document.getElementById('gYamH').value; if(!a||!b||!h) return; document.getElementById('gYamR').textContent=`Area: ${fp(0.5*(a+b)*h)}\nPerimeter â‰ˆ ${fp(a+b+2*Math.sqrt(h*h+((a-b)/2)**2))}`; }
function gKup()   { const a=+document.getElementById('gKupA').value; if(!a||a<0) return; document.getElementById('gKupR').textContent=`Volume: ${fp(a**3)}\nSurface Area: ${fp(6*a*a)}\nDiagonal: ${fp(a*Math.sqrt(3))}`; }
function gSil()   { const r=+document.getElementById('gSilR').value, h=+document.getElementById('gSilH').value; if(!r||!h) return; document.getElementById('gSilRes').textContent=`Volume: ${fp(Math.PI*r*r*h)}\nSurface Area: ${fp(2*Math.PI*r*(r+h))}`; }
function gKure()  { const r=+document.getElementById('gKureR').value; if(!r||r<0) return; document.getElementById('gKureRes').textContent=`Volume: ${fp(4/3*Math.PI*r**3)}\nSurface Area: ${fp(4*Math.PI*r*r)}`; }
function gKoni()  { const r=+document.getElementById('gKoniR').value, h=+document.getElementById('gKoniH').value; if(!r||!h) return; const l=Math.hypot(r,h); document.getElementById('gKoniRes').textContent=`Volume: ${fp(Math.PI*r*r*h/3)}\nSurface Area: ${fp(Math.PI*r*(r+l))}\nSlant height: ${fp(l)}`; }
function gPir()   { const a=+document.getElementById('gPirA').value, h=+document.getElementById('gPirH').value; if(!a||!h) return; const l=Math.hypot(a/2,h); document.getElementById('gPirRes').textContent=`Volume: ${fp(a*a*h/3)}\nSurface Area: ${fp(a*a+2*a*l)}\nSlant height: ${fp(l)}`; }
function gPit()   {
  const a=+document.getElementById('gPitA').value, b=+document.getElementById('gPitB').value, cv=+document.getElementById('gPitC').value;
  if(a&&b)         { document.getElementById('gPitRes').textContent=`c = ${fp(Math.hypot(a,b))}\nArea = ${fp(0.5*a*b)}`; }
  else if(a&&cv&&cv>a) { document.getElementById('gPitRes').textContent=`b = ${fp(Math.sqrt(cv*cv-a*a))}`; }
  else if(b&&cv&&cv>b) { document.getElementById('gPitRes').textContent=`a = ${fp(Math.sqrt(cv*cv-b*b))}`; }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   FORMULA LIBRARY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const FORMULAS = {
  algebra:[
    {n:'(a+b)Â²',e:'aÂ² + 2ab + bÂ²',d:'Square of a sum'},
    {n:'(aâˆ’b)Â²',e:'aÂ² âˆ’ 2ab + bÂ²',d:'Square of a difference'},
    {n:'(a+b)(aâˆ’b)',e:'aÂ² âˆ’ bÂ²',d:'Difference of squares'},
    {n:'(a+b)Â³',e:'aÂ³ + 3aÂ²b + 3abÂ² + bÂ³',d:''},
    {n:'(aâˆ’b)Â³',e:'aÂ³ âˆ’ 3aÂ²b + 3abÂ² âˆ’ bÂ³',d:''},
    {n:'aÂ³+bÂ³',e:'(a+b)(aÂ² âˆ’ ab + bÂ²)',d:'Sum of cubes'},
    {n:'aÂ³âˆ’bÂ³',e:'(aâˆ’b)(aÂ² + ab + bÂ²)',d:'Difference of cubes'},
    {n:'Quadratic Formula',e:'x = (âˆ’b Â± âˆš(bÂ²âˆ’4ac)) / 2a',d:'Solves axÂ²+bx+c=0'},
    {n:'Vieta â€” Sum of roots',e:'xâ‚+xâ‚‚ = âˆ’b/a',d:''},
    {n:'Vieta â€” Product of roots',e:'xâ‚Â·xâ‚‚ = c/a',d:''},
    {n:'Discriminant',e:'Î” = bÂ² âˆ’ 4ac',d:'Î”>0: two real roots, Î”=0: double root, Î”<0: complex'},
    {n:'Triangle Inequality',e:'|a+b| â‰¤ |a| + |b|',d:''},
    {n:'AM-GM Inequality',e:'(a+b)/2 â‰¥ âˆš(ab)',d:'Arithmetic mean â‰¥ Geometric mean'},
    {n:'Binomial Theorem',e:'(x+y)â¿ = Î£ C(n,k)Â·xâ¿â»áµÂ·yáµ',d:''},
  ],
  trig:[
    {n:'Pythagorean Identity',e:'sinÂ²Î¸ + cosÂ²Î¸ = 1',d:'Fundamental identity'},
    {n:'Tangent Identity',e:'tan Î¸ = sinÎ¸ / cosÎ¸',d:''},
    {n:'1 + tanÂ²Î¸',e:'secÂ²Î¸ = 1/cosÂ²Î¸',d:''},
    {n:'1 + cotÂ²Î¸',e:'cscÂ²Î¸ = 1/sinÂ²Î¸',d:''},
    {n:'Sum/Difference â€” sin',e:'sin(AÂ±B) = sinA cosB Â± cosA sinB',d:''},
    {n:'Sum/Difference â€” cos',e:'cos(AÂ±B) = cosA cosB âˆ“ sinA sinB',d:''},
    {n:'Sum Formula â€” tan',e:'tan(A+B) = (tanA+tanB)/(1âˆ’tanAtanB)',d:''},
    {n:'Double Angle â€” sin',e:'sin 2A = 2 sinA cosA',d:''},
    {n:'Double Angle â€” cos',e:'cos 2A = cosÂ²A âˆ’ sinÂ²A',d:''},
    {n:'Half Angle â€” sin',e:'sin(A/2) = Â±âˆš((1âˆ’cosA)/2)',d:''},
    {n:'Law of Sines',e:'a/sinA = b/sinB = c/sinC = 2R',d:''},
    {n:'Law of Cosines',e:'aÂ² = bÂ²+cÂ²âˆ’2bcÂ·cosA',d:''},
    {n:'Triangle Area',e:'A = (1/2)ab sinC',d:'Two sides and included angle'},
    {n:'Special Angles sin/cos',e:'sin30Â°=Â½, cos30Â°=âˆš3/2, sin45Â°=âˆš2/2',d:''},
  ],
  calculus:[
    {n:'Derivative Definition',e:"f'(x) = lim[hâ†’0] (f(x+h)âˆ’f(x))/h",d:''},
    {n:'Power Rule',e:'d/dx(xâ¿) = nÂ·xâ¿â»Â¹',d:''},
    {n:'Product Rule',e:"(uv)' = u'v + uv'",d:''},
    {n:'Quotient Rule',e:"(u/v)' = (u'v âˆ’ uv') / vÂ²",d:''},
    {n:'Chain Rule',e:"(fâˆ˜g)' = f'(g(x))Â·g'(x)",d:''},
    {n:'d/dx(sin x)',e:'cos x',d:''},
    {n:'d/dx(cos x)',e:'âˆ’sin x',d:''},
    {n:'d/dx(tan x)',e:'secÂ²x',d:''},
    {n:'d/dx(eË£)',e:'eË£',d:''},
    {n:'d/dx(ln x)',e:'1/x',d:''},
    {n:'d/dx(aË£)',e:'aË£ ln a',d:''},
    {n:"L'HÃ´pital's Rule",e:'lim f/g = lim f\'/g\' (for 0/0 or âˆ/âˆ)',d:''},
    {n:'Taylor Series',e:'f(x) = Î£ fâ½â¿â¾(a)/n! Â· (xâˆ’a)â¿',d:''},
    {n:'Maclaurin â€” eË£',e:'1 + x + xÂ²/2! + xÂ³/3! + â€¦',d:''},
  ],
  integral:[
    {n:'Power Rule',e:'âˆ«xâ¿ dx = xâ¿âºÂ¹/(n+1) + C',d:'n â‰  âˆ’1'},
    {n:'âˆ«1/x dx',e:'ln|x| + C',d:''},
    {n:'âˆ«eË£ dx',e:'eË£ + C',d:''},
    {n:'âˆ«aË£ dx',e:'aË£/ln a + C',d:''},
    {n:'âˆ«sin x dx',e:'âˆ’cos x + C',d:''},
    {n:'âˆ«cos x dx',e:'sin x + C',d:''},
    {n:'âˆ«tan x dx',e:'âˆ’ln|cos x| + C',d:''},
    {n:'âˆ«secÂ²x dx',e:'tan x + C',d:''},
    {n:'âˆ«1/âˆš(1âˆ’xÂ²) dx',e:'arcsin x + C',d:''},
    {n:'âˆ«1/(1+xÂ²) dx',e:'arctan x + C',d:''},
    {n:'Integration by Parts',e:'âˆ«u dv = uv âˆ’ âˆ«v du',d:''},
    {n:'Fundamental Theorem',e:'âˆ«[a,b] f(x)dx = F(b)âˆ’F(a)',d:'Definite integral'},
    {n:'Area under curve',e:'A = âˆ«[a,b] |f(x)| dx',d:''},
    {n:'Volume of revolution',e:'V = Ï€ âˆ«[a,b] [f(x)]Â² dx',d:'Around x-axis'},
  ],
  prob:[
    {n:'Permutation P(n,r)',e:'n! / (nâˆ’r)!',d:'Ordered selection'},
    {n:'Combination C(n,r)',e:'n! / (r!(nâˆ’r)!)',d:'Unordered selection'},
    {n:'Addition Rule',e:'P(AâˆªB) = P(A)+P(B)âˆ’P(Aâˆ©B)',d:''},
    {n:'Independent Events',e:'P(Aâˆ©B) = P(A)Â·P(B)',d:''},
    {n:'Conditional Probability',e:'P(A|B) = P(Aâˆ©B)/P(B)',d:''},
    {n:"Bayes' Theorem",e:'P(A|B) = P(B|A)Â·P(A)/P(B)',d:''},
    {n:'Expected Value',e:'E(X) = Î£ xáµ¢Â·P(xáµ¢)',d:''},
    {n:'Variance',e:'Var(X) = E(XÂ²)âˆ’[E(X)]Â²',d:''},
    {n:'Standard Deviation',e:'Ïƒ = âˆšVar(X)',d:''},
    {n:'Normal Distribution',e:'f(x) = (1/Ïƒâˆš2Ï€) e^(âˆ’(xâˆ’Î¼)Â²/2ÏƒÂ²)',d:''},
    {n:'Binomial Distribution',e:'P(X=k)=C(n,k)páµ(1âˆ’p)â¿â»áµ',d:''},
    {n:'Poisson Distribution',e:'P(X=k) = e^(âˆ’Î»)Â·Î»áµ/k!',d:''},
  ],
  series:[
    {n:'Arithmetic â€” nth term',e:'aâ‚™ = aâ‚ + (nâˆ’1)d',d:'d = common difference'},
    {n:'Arithmetic â€” sum',e:'Sâ‚™ = n(aâ‚+aâ‚™)/2',d:''},
    {n:'Geometric â€” nth term',e:'aâ‚™ = aâ‚Â·râ¿â»Â¹',d:'r = common ratio'},
    {n:'Geometric â€” sum',e:'Sâ‚™ = aâ‚(râ¿âˆ’1)/(râˆ’1)',d:'r â‰  1'},
    {n:'Infinite Geometric Series',e:'S = aâ‚/(1âˆ’r)',d:'|r| < 1'},
    {n:'Sum 1 to n',e:'Î£k = n(n+1)/2',d:''},
    {n:'Sum of squares',e:'Î£kÂ² = n(n+1)(2n+1)/6',d:''},
    {n:'Sum of cubes',e:'Î£kÂ³ = [n(n+1)/2]Â²',d:''},
    {n:'Fibonacci',e:'Fâ‚™ = Fâ‚™â‚‹â‚ + Fâ‚™â‚‹â‚‚',d:'Fâ‚=Fâ‚‚=1'},
    {n:'Golden Ratio Ï†',e:'Ï† = (1+âˆš5)/2 â‰ˆ 1.6180',d:'Fibonacci limit'},
  ],
  log:[
    {n:'Definition',e:'logâ‚b = c  âŸº  aá¶œ = b',d:''},
    {n:'Product Rule',e:'logâ‚(xy) = logâ‚x + logâ‚y',d:''},
    {n:'Quotient Rule',e:'logâ‚(x/y) = logâ‚x âˆ’ logâ‚y',d:''},
    {n:'Power Rule',e:'logâ‚(xâ¿) = nÂ·logâ‚x',d:''},
    {n:'Change of Base',e:'logâ‚b = logb/loga',d:''},
    {n:'Natural Log',e:'ln(eË£) = x,  e^(lnx) = x',d:''},
    {n:'log(1)',e:'= 0 (any base)',d:''},
    {n:'log(base)',e:'= 1',d:''},
    {n:'Exponential Growth',e:'A = Aâ‚€Â·eáµáµ—',d:'k>0 growth, k<0 decay'},
    {n:'Half-life',e:'tÂ½ = ln2/k',d:'Radioactive decay'},
  ],
  vectors:[
    {n:'Magnitude',e:'|v| = âˆš(xÂ²+yÂ²+zÂ²)',d:''},
    {n:'Unit Vector',e:'Ã» = v/|v|',d:''},
    {n:'Dot Product',e:'aÂ·b = |a||b|cosÎ¸',d:''},
    {n:'Cross Product magnitude',e:'|aÃ—b| = |a||b|sinÎ¸',d:''},
    {n:'Angle between vectors',e:'cosÎ¸ = (aÂ·b)/(|a||b|)',d:''},
    {n:'Projection',e:'projâ‚b = (aÂ·b/|a|Â²)a',d:''},
    {n:'Gradient',e:'âˆ‡f = (âˆ‚f/âˆ‚x, âˆ‚f/âˆ‚y, âˆ‚f/âˆ‚z)',d:''},
    {n:'Divergence',e:'âˆ‡Â·F = âˆ‚Fx/âˆ‚x+âˆ‚Fy/âˆ‚y+âˆ‚Fz/âˆ‚z',d:''},
  ],
  complex:[
    {n:'Complex Number',e:'z = a + bi',d:'a: real, b: imaginary part'},
    {n:'Modulus',e:'|z| = âˆš(aÂ²+bÂ²)',d:''},
    {n:'Argument',e:'arg(z) = arctan(b/a)',d:''},
    {n:'Polar Form',e:'z = r(cosÎ¸ + i sinÎ¸)',d:''},
    {n:"Euler's Formula",e:'eâ±Î¸ = cosÎ¸ + i sinÎ¸',d:''},
    {n:"Euler's Identity",e:'eâ±Ï€ + 1 = 0',d:'Most beautiful equation in math'},
    {n:'De Moivre',e:'(cosÎ¸+i sinÎ¸)â¿ = cos(nÎ¸)+i sin(nÎ¸)',d:''},
    {n:'zÂ·zÌ„',e:'= |z|Â² = aÂ²+bÂ²',d:'Conjugate product'},
    {n:'1/z',e:'= zÌ„/|z|Â²',d:'Complex reciprocal'},
    {n:'âˆšâˆ’1',e:'= i',d:'Imaginary unit'},
  ],
};

(function buildFormulas() {
  Object.entries(FORMULAS).forEach(([cat, items]) => {
    const el = document.getElementById('fg-'+cat);
    if(!el) return;
    el.innerHTML = items.map(f =>
      `<div class="fcard" onclick="copyFcard(this)" title="Click to copy">
        <div class="fcard-name">${f.n}</div>
        <div class="fcard-expr">${f.e}</div>
        ${f.d ? `<div class="fcard-desc">${f.d}</div>` : ''}
      </div>`
    ).join('');
  });
})();

function showFCat(cat, el) {
  document.querySelectorAll('#panel-formula .formula-grid').forEach(g => g.classList.remove('show'));
  document.querySelectorAll('#panel-formula .cat-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('fg-'+cat).classList.add('show');
  el.classList.add('active');
}
function copyFcard(card) {
  const txt = card.querySelector('.fcard-expr').textContent;
  if(navigator.clipboard) {
    navigator.clipboard.writeText(txt).then(() => toast('âœ“ FORMULA COPIED!'));
  } else {
    toast('âœ“ FORMULA COPIED!');
  }
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   UNIT CONVERTER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const UNITS = {
  len:     { units:['mm','cm','dm','m','km','in','ft','yd','mi','nmi'], base:{mm:0.001,cm:0.01,dm:0.1,m:1,km:1e3,in:0.0254,ft:0.3048,yd:0.9144,mi:1609.344,nmi:1852} },
  area:    { units:['mmÂ²','cmÂ²','mÂ²','kmÂ²','ha','acre','ftÂ²','inÂ²'], base:{'mmÂ²':1e-6,'cmÂ²':1e-4,'mÂ²':1,'kmÂ²':1e6,ha:1e4,acre:4046.86,'ftÂ²':0.0929,'inÂ²':6.452e-4} },
  vol:     { units:['ml','cl','dl','l','mÂ³','cmÂ³','inÂ³','ftÂ³','gal_us'], base:{ml:1e-3,cl:1e-2,dl:0.1,l:1,'mÂ³':1e3,'cmÂ³':1e-3,'inÂ³':0.016387,'ftÂ³':28.3168,gal_us:3.78541} },
  mass:    { units:['mg','g','kg','t','lb','oz'], base:{mg:1e-6,g:1e-3,kg:1,t:1000,lb:0.453592,oz:0.028350} },
  temp:    { units:['Â°C','Â°F','K','Â°R'], base:null },
  speed:   { units:['m/s','km/h','mph','knot','ft/s'], base:{'m/s':1,'km/h':1/3.6,mph:0.44704,knot:0.51444,'ft/s':0.3048} },
  angle:   { units:['degree','radian','gradian','revolution'], base:{degree:1,radian:180/Math.PI,gradian:0.9,revolution:360} },
  time:    { units:['ms','s','min','hr','day','week','month(30)','year'], base:{ms:1e-3,s:1,min:60,hr:3600,day:86400,week:604800,'month(30)':2592000,year:31536000} },
  energy:  { units:['J','kJ','MJ','cal','kcal','kWh','BTU'], base:{J:1,kJ:1e3,MJ:1e6,cal:4.184,kcal:4184,kWh:3.6e6,BTU:1055.06} },
  pressure:{ units:['Pa','kPa','MPa','bar','atm','psi','mmHg'], base:{Pa:1,kPa:1e3,MPa:1e6,bar:1e5,atm:101325,psi:6894.76,mmHg:133.322} },
};

let uCat = 'len';

function setUCat(cat, el) {
  uCat = cat;
  document.querySelectorAll('#unitCats .cat-btn').forEach(b => b.classList.remove('active'));
  el.classList.add('active');
  fillUSel(); doConv();
}
function fillUSel() {
  const d = UNITS[uCat];
  ['uFrom','uTo'].forEach((id, i) => {
    document.getElementById(id).innerHTML = d.units.map((u,j) =>
      `<option value="${u}"${j===(i===0?0:1)?' selected':''}>${u}</option>`
    ).join('');
  });
}
function doConv() {
  const val  = parseFloat(document.getElementById('uVal').value);
  const from = document.getElementById('uFrom').value;
  const to   = document.getElementById('uTo').value;
  if(isNaN(val)) { document.getElementById('uResult').textContent = 'â€”'; return; }
  let result;
  if(uCat === 'temp') {
    let c;
    if(from==='Â°C') c=val; else if(from==='Â°F') c=(val-32)*5/9; else if(from==='K') c=val-273.15; else c=val/1.8-273.15;
    if(to==='Â°C') result=c; else if(to==='Â°F') result=c*9/5+32; else if(to==='K') result=c+273.15; else result=(c+273.15)*1.8;
  } else {
    const d = UNITS[uCat];
    result = val * d.base[from] / d.base[to];
  }
  document.getElementById('uResult').textContent = +(result.toPrecision(10)) + '';
  if(UNITS[uCat].base) {
    const ratio = UNITS[uCat].base[from] / UNITS[uCat].base[to];
    document.getElementById('uFormula').textContent = `1 ${from} = ${+(ratio.toPrecision(8))} ${to}`;
  }
}
fillUSel();

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   MATRIX OPERATIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function buildMat() {
  const n  = parseInt(document.getElementById('matSize').value);
  const op = document.getElementById('matOp').value;
  document.getElementById('matBWrap').style.display = ['add','sub','mul'].includes(op) ? 'block' : 'none';
  ['A','B'].forEach(w => {
    const el = document.getElementById('mat'+w);
    el.innerHTML = '';
    for(let i=0; i<n; i++) {
      const row = document.createElement('div');
      row.className = 'mat-row';
      for(let j=0; j<n; j++) {
        const inp = document.createElement('input');
        inp.type = 'number'; inp.className = 'mat-cell';
        inp.id = `mc${w}${i}_${j}`;
        inp.value = i===j ? '1' : '0';
        row.appendChild(inp);
      }
      el.appendChild(row);
    }
  });
}

function getMat(w, n) {
  const m = [];
  for(let i=0; i<n; i++) {
    m.push([]);
    for(let j=0; j<n; j++) m[i].push(parseFloat(document.getElementById(`mc${w}${i}_${j}`).value) || 0);
  }
  return m;
}

function matDet(m, n) {
  if(n===1) return m[0][0];
  if(n===2) return m[0][0]*m[1][1] - m[0][1]*m[1][0];
  return m[0].reduce((s,v,j) => s + Math.pow(-1,j)*v*matDet(m.slice(1).map(r=>r.filter((_,c)=>c!==j)), n-1), 0);
}

function matInv(m, n) {
  const a = m.map((r,i) => [...r, ...Array.from({length:n},(_,j)=>+(i===j))]);
  for(let i=0; i<n; i++) {
    let pi = i;
    for(let k=i+1; k<n; k++) if(Math.abs(a[k][i]) > Math.abs(a[pi][i])) pi=k;
    [a[i],a[pi]] = [a[pi],a[i]];
    const pv = a[i][i];
    if(Math.abs(pv) < 1e-12) return null;
    a[i] = a[i].map(v => v/pv);
    for(let k=0; k<n; k++) {
      if(k===i) continue;
      const f = a[k][i];
      a[k] = a[k].map((v,j) => v - f*a[i][j]);
    }
  }
  return a.map(r => r.slice(n));
}

function matMul(A, B, n) {
  return Array.from({length:n}, (_,i) =>
    Array.from({length:n}, (_,j) =>
      A[i].reduce((s,v,k) => s + v*B[k][j], 0)
    )
  );
}

function matRank(m, n) {
  const a = m.map(r => [...r]);
  let rank = 0;
  for(let col=0; col<n && rank<n; col++) {
    let pi = rank;
    for(let k=rank+1; k<n; k++) if(Math.abs(a[k][col]) > Math.abs(a[pi][col])) pi=k;
    if(Math.abs(a[pi][col]) < 1e-10) continue;
    [a[rank],a[pi]] = [a[pi],a[rank]];
    const pv = a[rank][col];
    a[rank] = a[rank].map(v => v/pv);
    for(let k=0; k<n; k++) {
      if(k===rank) continue;
      const f = a[k][col];
      a[k] = a[k].map((v,j) => v - f*a[rank][j]);
    }
    rank++;
  }
  return rank;
}

function matStr(m) {
  return m.map(r => '[ ' + r.map(v => fp(v).padStart(10)).join('  ') + ' ]').join('\n');
}

function calcMat() {
  const n  = parseInt(document.getElementById('matSize').value);
  const op = document.getElementById('matOp').value;
  const A  = getMat('A', n);
  let out  = '';
  try {
    if(op==='det')   { out = `det(A) = ${fp(matDet(A,n))}`; }
    else if(op==='trace') { out = `trace(A) = ${fp(A.reduce((s,r,i)=>s+r[i],0))}`; }
    else if(op==='trans') { out = 'A^T =\n' + matStr(A[0].map((_,j)=>A.map(r=>r[j]))); }
    else if(op==='inv') {
      const d = matDet(A,n);
      if(Math.abs(d)<1e-12) { out = 'Singular matrix! det=0 â†’ No inverse.'; }
      else { const inv = matInv(A,n); out = 'Aâ»Â¹ =\n' + matStr(inv) + '\n\ndet(A) = ' + fp(d); }
    }
    else if(op==='add') { const B=getMat('B',n); out='A+B =\n'+matStr(A.map((r,i)=>r.map((v,j)=>v+B[i][j]))); }
    else if(op==='sub') { const B=getMat('B',n); out='Aâˆ’B =\n'+matStr(A.map((r,i)=>r.map((v,j)=>v-B[i][j]))); }
    else if(op==='mul') { const B=getMat('B',n); out='AÃ—B =\n'+matStr(matMul(A,B,n)); }
    else if(op==='pow') { out='AÂ² =\n'+matStr(matMul(A,A,n)); }
    else if(op==='rank') { out='rank(A) = '+matRank(A,n); }
  } catch(e) { out = 'Calculation error: '+e.message; }
  document.getElementById('matResult').textContent = out;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   NUMBER THEORY
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function isPrime(n) {
  n = Math.abs(Math.floor(n));
  if(n<2) return false;
  if(n===2||n===3) return true;
  if(n%2===0||n%3===0) return false;
  for(let i=5; i*i<=n; i+=6) if(n%i===0||n%(i+2)===0) return false;
  return true;
}
function gcd2(a,b) { a=Math.abs(a); b=Math.abs(b); while(b){[a,b]=[b,a%b];} return a; }
function lcm2(a,b) { return Math.abs(a)/gcd2(a,b)*Math.abs(b); }

function ntCheckPrime() {
  const n = parseInt(document.getElementById('ntPrime').value);
  if(isNaN(n)) { document.getElementById('ntPrimeR').textContent=''; return; }
  if(isPrime(n)) {
    document.getElementById('ntPrimeR').textContent = `${n} IS PRIME âœ“`;
  } else {
    const m = Math.abs(n);
    let sf = 2;
    while(sf*sf<=m && m%sf!==0) sf++;
    document.getElementById('ntPrimeR').textContent = `${n} is NOT prime.\nSmallest factor: ${m%sf===0?sf:'â€”'}`;
  }
}

function ntGcdLcm() {
  const nums = document.getElementById('ntGcd').value.split(/[,\s]+/).map(Number).filter(n=>Number.isInteger(n)&&n>0);
  if(nums.length<2) { document.getElementById('ntGcdR').textContent='Enter at least 2 numbers'; return; }
  const g = nums.reduce(gcd2);
  const l = nums.reduce(lcm2);
  document.getElementById('ntGcdR').textContent = `GCD: ${g}\nLCM: ${l}`;
}

function ntFactorize() {
  let n = parseInt(document.getElementById('ntFact').value);
  if(isNaN(n)||n<2) { document.getElementById('ntFactR').textContent=''; return; }
  const facs = {};
  for(let d=2; d*d<=n; d++) while(n%d===0){facs[d]=(facs[d]||0)+1; n/=d;}
  if(n>1) facs[n]=(facs[n]||0)+1;
  document.getElementById('ntFactR').textContent = Object.entries(facs).map(([p,e])=>e>1?`${p}^${e}`:p).join(' Ã— ');
}

function ntFactorial() {
  const n = parseInt(document.getElementById('ntFacN').value);
  if(isNaN(n)||n<0) { document.getElementById('ntFacR').textContent=''; return; }
  if(n>170) { document.getElementById('ntFacR').textContent='Too large (>170)'; return; }
  let f=1;
  for(let i=2; i<=n; i++) f*=i;
  document.getElementById('ntFacR').textContent = `${n}! = ${f}`;
}

function ntFib() {
  const n = parseInt(document.getElementById('ntFib').value);
  if(isNaN(n)||n<1||n>60) { document.getElementById('ntFibR').textContent=''; return; }
  const f = [0n,1n];
  for(let i=2; i<n; i++) f.push(f[i-1]+f[i-2]);
  document.getElementById('ntFibR').textContent = f.slice(0,n).join(', ');
}

function ntBase() {
  const num  = document.getElementById('ntBNum').value.trim();
  const from = parseInt(document.getElementById('ntBFrom').value);
  const to   = parseInt(document.getElementById('ntBTo').value);
  if(!num) { document.getElementById('ntBRes').textContent=''; return; }
  try {
    const dec = parseInt(num, from);
    if(isNaN(dec)) { document.getElementById('ntBRes').textContent='Invalid input'; return; }
    document.getElementById('ntBRes').textContent = dec.toString(to).toUpperCase();
  } catch(e) { document.getElementById('ntBRes').textContent = 'Error'; }
}

function ntEuclid() {
  let a = parseInt(document.getElementById('ntEA').value);
  let b = parseInt(document.getElementById('ntEB').value);
  if(isNaN(a)||isNaN(b)) { document.getElementById('ntEuclidR').textContent=''; return; }
  a=Math.abs(a); b=Math.abs(b);
  const steps = [`GCD(${a}, ${b})`];
  let [x,y] = [a,b];
  while(y!==0) {
    const q=Math.floor(x/y), r=x%y;
    steps.push(`${x} = ${q}Ã—${y} + ${r}`);
    [x,y]=[y,r];
  }
  steps.push(`GCD = ${x}`);
  document.getElementById('ntEuclidR').textContent = steps.join('\n');
}

function ntPhi() {
  let n = parseInt(document.getElementById('ntPhi').value);
  if(isNaN(n)||n<1) { document.getElementById('ntPhiR').textContent=''; return; }
  let phi=n, tmp=n;
  for(let p=2; p*p<=tmp; p++) { if(tmp%p===0){ while(tmp%p===0) tmp/=p; phi-=phi/p; } }
  if(tmp>1) phi-=phi/tmp;
  const divs=[];
  for(let i=1; i<=n; i++) if(n%i===0) divs.push(i);
  document.getElementById('ntPhiR').textContent = `Ï†(${n}) = ${Math.round(phi)}\nDivisors: ${divs.join(', ')}\nNumber of divisors: ${divs.length}`;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   STATISTICS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function calcStat() {
  const data = (document.getElementById('statData').value||'')
    .split(/[,\s]+/).map(Number).filter(n=>!isNaN(n)&&isFinite(n));
  if(data.length<1) { document.getElementById('statGrid').innerHTML=''; return; }
  const n      = data.length;
  const sorted = [...data].sort((a,b)=>a-b);
  const sum    = data.reduce((s,v)=>s+v,0);
  const mean   = sum/n;
  const variance   = data.reduce((s,v)=>s+(v-mean)**2,0)/n;
  const sVariance  = n>1 ? data.reduce((s,v)=>s+(v-mean)**2,0)/(n-1) : 0;
  const std    = Math.sqrt(variance);
  const sStd   = Math.sqrt(sVariance);
  const median = n%2===0 ? (sorted[n/2-1]+sorted[n/2])/2 : sorted[Math.floor(n/2)];
  const cnt={};  data.forEach(v=>cnt[v]=(cnt[v]||0)+1);
  const maxC   = Math.max(...Object.values(cnt));
  const mode   = Object.keys(cnt).filter(k=>cnt[k]===maxC).join(', ');
  const q1 = sorted[Math.floor(n*0.25)];
  const q3 = sorted[Math.floor(n*0.75)];
  const skew = std>0 ? (mean-median)/std : 0;

  const items = [
    ['Count (n)',n],['Sum',fp(sum)],['Mean',fp(mean)],['Median',fp(median)],
    ['Mode',mode],['Min',fp(sorted[0])],['Max',fp(sorted[n-1])],['Range',fp(sorted[n-1]-sorted[0])],
    ['Q1',fp(q1)],['Q3',fp(q3)],['IQR',fp(q3-q1)],
    ['Variance (pop)',fp(variance)],['Std Dev (pop)',fp(std)],
    ['Std Dev (sample)',fp(sStd)],['Skewness',fp(skew)],
  ];
  document.getElementById('statGrid').innerHTML = items.map(([k,v])=>
    `<div class="stat-item"><div class="stat-key">${k}</div><div class="stat-val">${v}</div></div>`
  ).join('');

  // Bar chart
  const canvas = document.getElementById('statChart');
  resizeC('statChart'); canvas.height = 200;
  const ctx = canvas.getContext('2d');
  ctx.fillStyle = '#030010'; ctx.fillRect(0,0,canvas.width,200);
  const mx = Math.max(...data.map(Math.abs)) || 1;
  const bw = Math.max(3, (canvas.width-40)/data.length - 2);
  data.forEach((v,i) => {
    const bh = Math.abs(v/mx)*(canvas.height-30);
    const x  = 20 + i*(bw+2);
    ctx.fillStyle = `hsl(${270+(i/data.length)*90},100%,60%)`;
    ctx.fillRect(x, canvas.height-bh-10, bw, bh);
    if(bw>16) { ctx.fillStyle='rgba(255,255,255,0.55)'; ctx.font='9px Share Tech Mono'; ctx.fillText(v, x, canvas.height-bh-13); }
  });
  const my = canvas.height - (mean/mx)*(canvas.height-30) - 10;
  ctx.strokeStyle='#ff2d78'; ctx.lineWidth=1.5; ctx.setLineDash([4,3]);
  ctx.beginPath(); ctx.moveTo(20,my); ctx.lineTo(canvas.width-10,my); ctx.stroke();
  ctx.setLineDash([]);
  ctx.fillStyle='#ff2d78'; ctx.font='10px Share Tech Mono';
  ctx.fillText('xÌ„='+fp(mean), canvas.width-80, my-3);
}

function calcReg() {
  const xs = document.getElementById('regX').value.split(',').map(Number).filter(n=>!isNaN(n));
  const ys = document.getElementById('regY').value.split(',').map(Number).filter(n=>!isNaN(n));
  if(xs.length!==ys.length||xs.length<2) { document.getElementById('regResult').textContent='Enter equal-length X and Y arrays (min 2)'; return; }
  const n  = xs.length;
  const sx = xs.reduce((s,v)=>s+v,0), sy=ys.reduce((s,v)=>s+v,0);
  const sxy = xs.reduce((s,v,i)=>s+v*ys[i],0), sxx=xs.reduce((s,v)=>s+v*v,0);
  const slope = (n*sxy-sx*sy)/(n*sxx-sx*sx);
  const inter = (sy-slope*sx)/n;
  const yMean = sy/n;
  const ssTot = ys.reduce((s,v)=>s+(v-yMean)**2,0);
  const ssRes = ys.reduce((s,v,i)=>s+(v-(slope*xs[i]+inter))**2,0);
  const r2 = 1-ssRes/ssTot;
  document.getElementById('regResult').textContent =
    `y = ${fp(slope)}x + ${fp(inter)}\nSlope (m): ${fp(slope)}\nIntercept (b): ${fp(inter)}\nRÂ² = ${fp(r2)}`;

  const canvas = document.getElementById('regChart');
  resizeC('regChart'); canvas.height = 200;
  const ctx = canvas.getContext('2d');
  ctx.fillStyle='#030010'; ctx.fillRect(0,0,canvas.width,200);
  const xMin=Math.min(...xs)-1, xMax=Math.max(...xs)+1;
  const yMin=Math.min(...ys)-1, yMax=Math.max(...ys)+1;
  const px=x=>(x-xMin)/(xMax-xMin)*(canvas.width-40)+20;
  const py=y=>canvas.height-20-(y-yMin)/(yMax-yMin)*(canvas.height-40);
  ctx.strokeStyle='rgba(155,89,255,0.3)'; ctx.lineWidth=1;
  ctx.beginPath(); ctx.moveTo(20,canvas.height-20); ctx.lineTo(canvas.width-20,canvas.height-20); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(20,10); ctx.lineTo(20,canvas.height-20); ctx.stroke();
  xs.forEach((x,i)=>{ ctx.fillStyle='#00f5ff'; ctx.beginPath(); ctx.arc(px(x),py(ys[i]),4,0,Math.PI*2); ctx.fill(); });
  ctx.strokeStyle='#ff2d78'; ctx.lineWidth=2;
  ctx.beginPath(); ctx.moveTo(px(xMin),py(slope*xMin+inter)); ctx.lineTo(px(xMax),py(slope*xMax+inter)); ctx.stroke();
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   EQUATION SOLVER
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function showEq(id, el) {
  document.querySelectorAll('.eq-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('#panel-equation .cat-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('eq-'+id).classList.add('active');
  el.classList.add('active');
}

function solveLinear() {
  const a=+document.getElementById('eLA').value, b=+document.getElementById('eLB').value;
  if(a===0) { document.getElementById('eLinR').textContent = b===0?'Infinite solutions':'No solution'; return; }
  const x = -b/a;
  document.getElementById('eLinR').textContent = `x = ${fp(x)}\n\nVerification: ${fp(a)}Â·${fp(x)} + ${fp(b)} = ${fp(a*x+b)}`;
}

function solveQuad() {
  const a=+document.getElementById('eQA').value, b=+document.getElementById('eQB').value, c=+document.getElementById('eQC').value;
  if(a===0) { document.getElementById('eQuadR').textContent='a cannot be 0 for quadratic'; return; }
  const D = b*b - 4*a*c;
  if(D>0) {
    const x1=(-b+Math.sqrt(D))/(2*a), x2=(-b-Math.sqrt(D))/(2*a);
    document.getElementById('eQuadR').textContent =
      `Î” = ${fp(D)} > 0 (two real roots)\nxâ‚ = ${fp(x1)}\nxâ‚‚ = ${fp(x2)}\n\nxâ‚+xâ‚‚ = ${fp(x1+x2)} (should be ${fp(-b/a)})\nxâ‚Â·xâ‚‚ = ${fp(x1*x2)} (should be ${fp(c/a)})`;
  } else if(D===0) {
    document.getElementById('eQuadR').textContent = `Î” = 0 â†’ Double root\nx = ${fp(-b/(2*a))}`;
  } else {
    const re=-b/(2*a), im=Math.sqrt(-D)/(2*a);
    document.getElementById('eQuadR').textContent =
      `Î” = ${fp(D)} < 0 â†’ Complex roots\nxâ‚ = ${fp(re)} + ${fp(im)}i\nxâ‚‚ = ${fp(re)} âˆ’ ${fp(im)}i`;
  }
}

function solveCubic() {
  const a=+document.getElementById('eCuA').value, b=+document.getElementById('eCuB').value;
  const c=+document.getElementById('eCuC').value, d=+document.getElementById('eCuD').value;
  if(a===0) { document.getElementById('eCubicR').textContent='a cannot be 0; use quadratic solver'; return; }
  const f  = x => a*x**3 + b*x**2 + c*x + d;
  const fp2= x => 3*a*x**2 + 2*b*x + c;
  const roots=[]; const seen=new Set();
  // Scan for sign changes
  for(let t=-200; t<=200; t+=0.05) {
    const fv=f(t), fv2=f(t+0.05);
    if(isFinite(fv)&&isFinite(fv2)&&Math.sign(fv)!==Math.sign(fv2)) {
      let x=(t+t+0.05)/2;
      for(let i=0;i<60;i++){ const fvv=f(x),fpv=fp2(x); if(Math.abs(fpv)<1e-14) break; x-=fvv/fpv; if(!isFinite(x)) break; }
      const key=Math.round(x*1000);
      if(!seen.has(key)&&Math.abs(f(x))<1e-6){ seen.add(key); roots.push(x); }
    }
  }
  if(roots.length===0) { document.getElementById('eCubicR').textContent='No real roots found (may have complex roots)'; return; }
  document.getElementById('eCubicR').textContent = roots.map((r,i) =>
    `x${i+1} = ${fp(r)}\n  f(${fp(r)}) = ${fp(f(r))}`
  ).join('\n');
}

function solveSys2() {
  const a1=+document.getElementById('s2A1').value, b1=+document.getElementById('s2B1').value, c1=+document.getElementById('s2C1').value;
  const a2=+document.getElementById('s2A2').value, b2=+document.getElementById('s2B2').value, c2=+document.getElementById('s2C2').value;
  const D = a1*b2 - a2*b1;
  if(Math.abs(D)<1e-12) { document.getElementById('eSys2R').textContent='det=0 â†’ No unique solution'; return; }
  const x=(c1*b2-c2*b1)/D, y=(a1*c2-a2*c1)/D;
  document.getElementById('eSys2R').textContent =
    `x = ${fp(x)}\ny = ${fp(y)}\n\nVerification:\n${fp(a1)}x+${fp(b1)}y = ${fp(a1*x+b1*y)} (expected ${fp(c1)})\n${fp(a2)}x+${fp(b2)}y = ${fp(a2*x+b2*y)} (expected ${fp(c2)})`;
}

function solveSys3() {
  const v = id => +document.getElementById(id).value;
  const A = [
    [v('s3A1'),v('s3B1'),v('s3C1'),v('s3D1')],
    [v('s3A2'),v('s3B2'),v('s3C2'),v('s3D2')],
    [v('s3A3'),v('s3B3'),v('s3C3'),v('s3D3')],
  ];
  const m = A.map(r=>[...r]);
  for(let i=0; i<3; i++) {
    let pi=i;
    for(let k=i+1; k<3; k++) if(Math.abs(m[k][i])>Math.abs(m[pi][i])) pi=k;
    [m[i],m[pi]]=[m[pi],m[i]];
    if(Math.abs(m[i][i])<1e-12){ document.getElementById('eSys3R').textContent='Singular system: no unique solution'; return; }
    for(let k=0; k<3; k++) {
      if(k===i) continue;
      const f=m[k][i]/m[i][i];
      m[k]=m[k].map((v,j)=>v-f*m[i][j]);
    }
  }
  const x=m[0][3]/m[0][0], y=m[1][3]/m[1][1], z=m[2][3]/m[2][2];
  document.getElementById('eSys3R').textContent = `x = ${fp(x)}\ny = ${fp(y)}\nz = ${fp(z)}`;
}

function solveNewton() {
  const exprStr = document.getElementById('eNRF').value;
  let x = parseFloat(document.getElementById('eNRX0').value) || 1;
  const h = 1e-7;
  const steps = [];
  for(let i=0; i<60; i++) {
    let fx, fxh;
    try { fx  = Function('"use strict";const x='+x+';return '+exprStr)(); } catch(e){ break; }
    try { fxh = Function('"use strict";const x='+(x+h)+';return '+exprStr)(); } catch(e){ break; }
    const fpx = (fxh-fx)/h;
    if(Math.abs(fpx)<1e-15) break;
    const xNew = x - fx/fpx;
    if(i<5) steps.push(`Iter ${i+1}: x=${fp(x)}, f(x)=${fp(fx)}`);
    if(Math.abs(xNew-x)<1e-11){ x=xNew; break; }
    x = xNew;
  }
  let fx2;
  try { fx2 = Function('"use strict";const x='+x+';return '+exprStr)(); } catch(e){ fx2=NaN; }
  document.getElementById('eNRR').textContent =
    `Root: x = ${fp(x)}\nf(x) = ${fp(fx2)}\n\n${steps.join('\n')}`;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   FRACTIONS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function fracStr(n,d) {
  if(d===0) return 'undefined';
  const g = gcd2(Math.abs(n),Math.abs(d));
  const sn=n/g, sd=d/g;
  return sd===1 ? `${sn}` : `${sn}/${sd}`;
}
function simplifyFrac() {
  const n=+document.getElementById('fSimN').value, d=+document.getElementById('fSimD').value;
  if(!d){ document.getElementById('fSimR').textContent='Denominator cannot be 0'; return; }
  document.getElementById('fSimR').textContent = `${n}/${d} = ${fracStr(n,d)}\nDecimal: ${fp(n/d)}`;
}
function addFrac() {
  const n1=+document.getElementById('fAN1').value, d1=+document.getElementById('fAD1').value;
  const n2=+document.getElementById('fAN2').value, d2=+document.getElementById('fAD2').value;
  const n=n1*d2+n2*d1, d=d1*d2;
  document.getElementById('fAddR').textContent = `${n1}/${d1} + ${n2}/${d2} = ${n}/${d} = ${fracStr(n,d)}\nâ‰ˆ ${fp(n/d)}`;
}
function subFrac() {
  const n1=+document.getElementById('fSN1').value, d1=+document.getElementById('fSD1').value;
  const n2=+document.getElementById('fSN2').value, d2=+document.getElementById('fSD2').value;
  const n=n1*d2-n2*d1, d=d1*d2;
  document.getElementById('fSubR').textContent = `${n1}/${d1} âˆ’ ${n2}/${d2} = ${n}/${d} = ${fracStr(n,d)}\nâ‰ˆ ${fp(n/d)}`;
}
function mulFrac() {
  const n1=+document.getElementById('fMN1').value, d1=+document.getElementById('fMD1').value;
  const n2=+document.getElementById('fMN2').value, d2=+document.getElementById('fMD2').value;
  const n=n1*n2, d=d1*d2;
  document.getElementById('fMulR').textContent = `${n1}/${d1} Ã— ${n2}/${d2} = ${n}/${d} = ${fracStr(n,d)}\nâ‰ˆ ${fp(n/d)}`;
}
function divFrac() {
  const n1=+document.getElementById('fDivN1').value, d1=+document.getElementById('fDivD1').value;
  const n2=+document.getElementById('fDivN2').value, d2=+document.getElementById('fDivD2').value;
  if(n2===0){ document.getElementById('fDivR').textContent='Cannot divide by zero'; return; }
  const n=n1*d2, d=d1*n2;
  document.getElementById('fDivR').textContent = `${n1}/${d1} Ã· ${n2}/${d2} = ${n1*d2}/${d1*n2} = ${fracStr(n,d)}\nâ‰ˆ ${fp(n/d)}`;
}
function decToFrac() {
  let x = parseFloat(document.getElementById('fDecInp').value);
  if(isNaN(x)){ document.getElementById('fDecR').textContent=''; return; }
  const sign = x<0 ? -1 : 1; x = Math.abs(x);
  const eps=1e-9, maxD=10000;
  let bestN=0, bestD=1, bestErr=x;
  for(let d=1; d<=maxD; d++) {
    const n=Math.round(x*d), err=Math.abs(n/d-x);
    if(err<bestErr){ bestErr=err; bestN=n; bestD=d; }
    if(bestErr<eps) break;
  }
  document.getElementById('fDecR').textContent =
    `${sign<0?'-':''}${bestN}/${bestD} = ${fracStr(sign*bestN,bestD)}\nVerification: ${fp(sign*bestN/bestD)}`;
}

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   WINDOW RESIZE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
window.addEventListener('resize', () => {
  if(document.getElementById('panel-graph').classList.contains('active')) drawGraph();
  if(document.getElementById('panel-draw').classList.contains('active') && dCanvas) {
    const newW = dCanvas.offsetWidth;
    if(newW && newW !== dCanvas.width) {
      const snap = dCtx.getImageData(0,0,dCanvas.width,dCanvas.height);
      dCanvas.width = newW;
      fillBg();
      dCtx.putImageData(snap,0,0);
    }
  }
});

/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   INITIALIZATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
window.addEventListener('DOMContentLoaded', () => {
  buildMat();
  initGeoShapes();
  calcStat();
  setTimeout(() => { resizeC('graphCanvas'); drawGraph(); }, 150);
});
</script>
</body>
</html>
